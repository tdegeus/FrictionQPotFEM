import unittest

import FrictionQPotFEM
import GMatElastoPlasticQPot.Cartesian2d as GMat
import GooseFEM
import numpy as np
import prrng


class test_Generic2d(unittest.TestCase):
    """
    Tests
    """

    def test_historic(self):
        """
        A simple historic run.
        Thanks to prrng this test can be run on any platform, but also from any API (Python or C++).
        """

        check_Eps = np.array(
            [
                0,
                2e-06,
                4e-06,
                6e-06,
                8e-06,
                1e-05,
                1.2e-05,
                1.4e-05,
                1.6e-05,
                1.8e-05,
                2e-05,
                2.2e-05,
                2.4e-05,
                2.6e-05,
                2.8e-05,
                3e-05,
                3.2e-05,
                3.4e-05,
                3.6e-05,
                3.8e-05,
                4e-05,
                4.2e-05,
                4.4e-05,
                4.6e-05,
                4.8e-05,
                5e-05,
                5.2e-05,
                5.4e-05,
                5.6e-05,
                5.8e-05,
                6e-05,
                6.2e-05,
                6.4e-05,
                6.6e-05,
                6.8e-05,
                7e-05,
                7.2e-05,
                7.4e-05,
                7.6e-05,
                7.8e-05,
                8e-05,
                8.2e-05,
                8.4e-05,
                8.6e-05,
                8.8e-05,
                9e-05,
                9.2e-05,
                9.4e-05,
                9.6e-05,
                9.8e-05,
                0.0001,
                0.000102,
                0.000104,
                0.000106,
                0.000108,
                0.00011,
                0.000112,
                0.000114,
                0.000116,
                0.000118,
                0.00012,
                0.000122,
                0.000124,
                0.000126,
                0.000128,
                0.00013,
                0.000132,
                0.000134,
                0.000136,
                0.000138,
                0.00014,
                0.000142,
                0.000144,
                0.000146,
                0.000148,
                0.00015,
                0.000152,
                0.000154,
                0.000156,
                0.000158,
                0.00016,
                0.000162,
                0.000164,
                0.000166,
                0.000168,
                0.00017,
                0.000172,
                0.000174,
                0.000176,
                0.000178,
                0.00018,
                0.000182,
                0.000184,
                0.000186,
                0.000188,
                0.00019,
                0.000192,
                0.000194,
                0.000196,
                0.000198,
                0.0002,
                0.000202,
                0.000204,
                0.000206,
                0.000208,
                0.00021,
                0.000212,
                0.000214,
                0.000216,
                0.000218,
                0.00022,
                0.000222,
                0.000224,
                0.000226,
                0.000228,
                0.00023,
                0.000232,
                0.000234,
                0.000236,
                0.000238,
                0.00024,
                0.000242,
                0.000244,
                0.000246,
                0.000248,
                0.00025,
                0.000252,
                0.000254,
                0.000256,
                0.000258,
                0.00026,
                0.000262,
                0.000264,
                0.000266,
                0.000268,
                0.00027,
                0.000272,
                0.000274,
                0.000276,
                0.000278,
                0.00028,
                0.000282,
                0.000284,
                0.000286,
                0.000288,
                0.00029,
                0.000292,
                0.000294,
                0.000296,
                0.000298,
                0.0003,
                0.000302,
                0.000304,
                0.000306,
                0.000308,
                0.00031,
                0.000312,
                0.000314,
                0.000316,
                0.000318,
                0.00032,
                0.000322,
                0.000324,
                0.000326,
                0.000328,
                0.00033,
                0.000332,
                0.000334,
                0.000336,
                0.000338,
                0.00034,
                0.000342,
                0.000344,
                0.000346,
                0.000348,
                0.00035,
                0.000352,
                0.000354,
                0.000356,
                0.000358,
                0.00036,
                0.000362,
                0.000364,
                0.000366,
                0.000368,
                0.00037,
                0.000372,
                0.000374,
                0.000376,
                0.000378,
                0.00038,
                0.000382,
                0.000384,
                0.000386,
                0.000388,
                0.00039,
                0.000392,
                0.000394,
                0.000396,
                0.000398,
                0.0004,
                0.000402,
                0.000404,
                0.000406,
                0.000408,
                0.00041,
                0.000412,
                0.000414,
                0.000416,
                0.000418,
                0.00042,
                0.000422,
                0.000424,
                0.000426,
                0.000428,
                0.00043,
                0.000432,
                0.000434,
                0.000436,
                0.000438,
                0.00044,
                0.000442,
                0.000444,
                0.000446,
                0.000448,
                0.00045,
                0.000452,
                0.000454,
                0.000456,
                0.000458,
                0.00046,
                0.000462,
                0.000464,
                0.000466,
                0.000468,
                0.00047,
                0.000472,
                0.000474,
                0.000476,
                0.000478,
                0.00048,
                0.000482,
                0.000484,
                0.000486,
                0.000488,
                0.00049,
                0.000492,
                0.000494,
                0.000496,
                0.000498,
                0.0005,
                0.000502,
                0.000504,
                0.000506,
                0.000508,
                0.00051,
                0.000512,
                0.000514,
                0.000516,
                0.000518,
                0.00052,
                0.000522,
                0.000524,
                0.000526,
                0.000528,
                0.00053,
                0.000532,
                0.000534,
                0.000536,
                0.000538,
                0.00054,
                0.000542,
                0.000544,
                0.000546,
                0.000548,
                0.00055,
                0.000552,
                0.000554,
                0.000556,
                0.000558,
                0.00056,
                0.000562,
                0.000564,
                0.000566,
                0.000568,
                0.00057,
                0.000572,
                0.000574,
                0.000576,
                0.000578,
                0.00058,
                0.000582,
                0.000584,
                0.000586,
                0.000588,
                0.00059,
                0.000592,
                0.000594,
                0.000596,
                0.000598,
                0.0006,
                0.000602,
                0.000604,
                0.000606,
                0.000608,
                0.00061,
                0.000612,
                0.000614,
                0.000616,
                0.000618,
                0.00062,
                0.000622,
                0.000624,
                0.000626,
                0.000628,
                0.00063,
                0.000632,
                0.000634,
                0.000636,
                0.000638,
                0.00064,
                0.000642,
                0.000644,
                0.000646,
                0.000648,
                0.00065,
                0.000652,
                0.000654,
                0.000656,
                0.000658,
                0.00066,
                0.000662,
                0.000664,
                0.000666,
                0.000668,
                0.00067,
                0.000672,
                0.000674,
                0.000676,
                0.000678,
                0.00068,
                0.000682,
                0.000684,
                0.000686,
                0.000688,
                0.00069,
                0.000692,
                0.000694,
                0.000696,
                0.000698,
                0.0007,
                0.000702,
                0.000704,
                0.000706,
                0.000708,
                0.00071,
                0.000712,
                0.000714,
                0.000716,
                0.000718,
                0.00072,
                0.000722,
                0.000724,
                0.000726,
                0.000728,
                0.00073,
                0.000732,
                0.000734,
                0.000736,
                0.000738,
                0.00074,
                0.000742,
                0.000744,
                0.000746,
                0.000748,
                0.00075,
                0.000752,
                0.000754,
                0.000756,
                0.000758,
                0.00076,
                0.000762,
                0.000764,
                0.000766,
                0.000768,
                0.00077,
                0.000772,
                0.000774,
                0.000776,
                0.000778,
                0.00078,
                0.000782,
                0.000784,
                0.000786,
                0.000788,
                0.00079,
                0.000792,
                0.000794,
                0.000796,
                0.000798,
                0.0008,
                0.000802,
                0.000804,
                0.000806,
                0.000808,
                0.00081,
                0.000812,
                0.000814,
                0.000816,
                0.000818,
                0.00082,
                0.000822,
                0.000824,
                0.000826,
                0.000828,
                0.00083,
                0.000832,
                0.000834,
                0.000836,
                0.000838,
                0.00084,
                0.000842,
                0.000844,
                0.000846,
                0.000848,
                0.00085,
                0.000852,
                0.000854,
                0.000856,
                0.000858,
                0.00086,
                0.000862,
                0.000864,
                0.000866,
                0.000868,
                0.00087,
                0.000872,
                0.000874,
                0.000876,
                0.000878,
                0.00088,
                0.000882,
                0.000884,
                0.000886,
                0.000888,
                0.00089,
                0.000892,
                0.000894,
                0.000896,
                0.000898,
                0.0009,
                0.000902,
                0.000904,
                0.000906,
                0.000908,
                0.00091,
                0.000912,
                0.000914,
                0.000916,
                0.000918,
                0.00092,
                0.000922,
                0.000924,
                0.000926,
                0.000928,
                0.00093,
                0.000932,
                0.000934,
                0.000936,
                0.000938,
                0.00094,
                0.000942,
                0.000944,
                0.000946,
                0.000948,
                0.00095,
                0.000952,
                0.000954,
                0.000956,
                0.000958,
                0.00096,
                0.000962,
                0.000964,
                0.000966,
                0.000968,
                0.00097,
                0.000972,
                0.000974,
                0.000976,
                0.000978,
                0.00098,
                0.000982,
                0.000984,
                0.000986,
                0.000988,
                0.00099,
                0.000992,
                0.000994,
                0.000996,
                0.000998,
                0.001,
                0.001002,
                0.001004,
                0.001006,
                0.001008,
                0.00101,
                0.001012,
                0.001014,
                0.001016,
                0.001018,
                0.00102,
                0.001022,
                0.001024,
                0.001026,
                0.001028,
                0.00103,
                0.001032,
                0.001034,
                0.001036,
                0.001038,
                0.00104,
                0.001042,
                0.001044,
                0.001046,
                0.001048,
                0.00105,
                0.001052,
                0.001054,
                0.001056,
                0.001058,
                0.00106,
                0.001062,
                0.001064,
                0.001066,
                0.001068,
                0.00107,
                0.001072,
                0.001074,
                0.001076,
                0.001078,
                0.00108,
                0.001082,
                0.001084,
                0.001086,
                0.001088,
                0.00109,
                0.001092,
                0.001094,
                0.001096,
                0.001098,
                0.0011,
                0.001102,
                0.001104,
                0.001106,
                0.001108,
                0.00111,
                0.001112,
                0.001114,
                0.001116,
                0.001118,
                0.00112,
                0.001122,
                0.001124,
                0.001126,
                0.001128,
                0.00113,
                0.001132,
                0.001134,
                0.001136,
                0.001138,
                0.00114,
                0.001142,
                0.001144,
                0.001146,
                0.001148,
                0.00115,
                0.001152,
                0.001154,
                0.001156,
                0.001158,
                0.00116,
                0.001162,
                0.001164,
                0.001166,
                0.001168,
                0.00117,
                0.001172,
                0.001174,
                0.001176,
                0.001178,
                0.00118,
                0.001182,
                0.001184,
                0.001186,
                0.001188,
                0.00119,
                0.001192,
                0.001194,
                0.001196,
                0.001198,
                0.0012,
                0.001202,
                0.001204,
                0.001206,
                0.001208,
                0.00121,
                0.001212,
                0.001214,
                0.001216,
                0.001218,
                0.00122,
                0.001222,
                0.001224,
                0.001226,
                0.001228,
                0.00123,
                0.001232,
                0.001234,
                0.001236,
                0.001238,
                0.00124,
                0.001242,
                0.001244,
                0.001246,
                0.001248,
                0.00125,
                0.001252,
                0.001254,
                0.001256,
                0.001258,
                0.00126,
                0.001262,
                0.001264,
                0.001266,
                0.001268,
                0.00127,
                0.001272,
                0.001274,
                0.001276,
                0.001278,
                0.00128,
                0.001282,
                0.001284,
                0.001286,
                0.001288,
                0.00129,
                0.001292,
                0.001294,
                0.001296,
                0.001298,
                0.0013,
                0.001302,
                0.001304,
                0.001306,
                0.001308,
                0.00131,
                0.001312,
                0.001314,
                0.001316,
                0.001318,
                0.00132,
                0.001322,
                0.001324,
                0.001326,
                0.001328,
                0.00133,
                0.001332,
                0.001334,
                0.001336,
                0.001338,
                0.00134,
                0.001342,
                0.001344,
                0.001346,
                0.001348,
                0.00135,
                0.001352,
                0.001354,
                0.001356,
                0.001358,
                0.00136,
                0.001362,
                0.001364,
                0.001366,
                0.001368,
                0.00137,
                0.001372,
                0.001374,
                0.001376,
                0.001378,
                0.00138,
                0.001382,
                0.001384,
                0.001386,
                0.001388,
                0.00139,
                0.001392,
                0.001394,
                0.001396,
                0.001398,
                0.0014,
                0.001402,
                0.001404,
                0.001406,
                0.001408,
                0.00141,
                0.001412,
                0.001414,
                0.001416,
                0.001418,
                0.00142,
                0.001422,
                0.001424,
                0.001426,
                0.001428,
                0.00143,
                0.001432,
                0.001434,
                0.001436,
                0.001438,
                0.00144,
                0.001442,
                0.001444,
                0.001446,
                0.001448,
                0.00145,
                0.001452,
                0.001454,
                0.001456,
                0.001458,
                0.00146,
                0.001462,
                0.001464,
                0.001466,
                0.001468,
                0.00147,
                0.001472,
                0.001474,
                0.001476,
                0.001478,
                0.00148,
                0.001482,
                0.001484,
                0.001486,
                0.001488,
                0.00149,
                0.001492,
                0.001494,
                0.001496,
                0.001498,
                0.0015,
                0.001502,
                0.001504,
                0.001506,
                0.001508,
                0.00151,
                0.001512,
                0.001514,
                0.001516,
                0.001518,
                0.00152,
                0.001522,
                0.001524,
                0.001526,
                0.001528,
                0.00153,
                0.001532,
                0.001534,
                0.001536,
                0.001538,
                0.00154,
                0.001542,
                0.001544,
                0.001546,
                0.001548,
                0.00155,
                0.001552,
                0.001554,
                0.001556,
                0.001558,
                0.00156,
                0.001562,
                0.001564,
                0.001566,
                0.001568,
                0.00157,
                0.001572,
                0.001574,
                0.001576,
                0.001578,
                0.00158,
                0.001582,
                0.001584,
                0.001586,
                0.001588,
                0.00159,
                0.001592,
                0.001594,
                0.001596,
                0.001598,
                0.0016,
                0.001602,
                0.001604,
                0.001606,
                0.001608,
                0.00161,
                0.001612,
                0.001614,
                0.001616,
                0.001618,
                0.00162,
                0.001622,
                0.001624,
                0.001626,
                0.001628,
                0.00163,
                0.001632,
                0.001634,
                0.001636,
                0.001638,
                0.00164,
                0.001642,
                0.001644,
                0.001646,
                0.001648,
                0.00165,
                0.001652,
                0.001654,
                0.001656,
                0.001658,
                0.00166,
                0.001662,
                0.001664,
                0.001666,
                0.001668,
                0.00167,
                0.001672,
                0.001674,
                0.001676,
                0.001678,
                0.00168,
                0.001682,
                0.001684,
                0.001686,
                0.001688,
                0.00169,
                0.001692,
                0.001694,
                0.001696,
                0.001698,
                0.0017,
                0.001702,
                0.001704,
                0.001706,
                0.001708,
                0.00171,
                0.001712,
                0.001714,
                0.001716,
                0.001718,
                0.00172,
                0.001722,
                0.001724,
                0.001726,
                0.001728,
                0.00173,
                0.001732,
                0.001734,
                0.001736,
                0.001738,
                0.00174,
                0.001742,
                0.001744,
                0.001746,
                0.001748,
                0.00175,
                0.001752,
                0.001754,
                0.001756,
                0.001758,
                0.00176,
                0.001762,
                0.001764,
                0.001766,
                0.001768,
                0.00177,
                0.001772,
                0.001774,
                0.001776,
                0.001778,
                0.00178,
                0.001782,
                0.001784,
                0.001786,
                0.001788,
                0.00179,
                0.001792,
                0.001794,
                0.001796,
                0.001798,
                0.0018,
                0.001802,
                0.001804,
                0.001806,
                0.001808,
                0.00181,
                0.001812,
                0.001814,
                0.001816,
                0.001818,
                0.00182,
                0.001822,
                0.001824,
                0.001826,
                0.001828,
                0.00183,
                0.001832,
                0.001834,
                0.001836,
                0.001838,
                0.00184,
                0.001842,
                0.001844,
                0.001846,
                0.001848,
                0.00185,
                0.001852,
                0.001854,
                0.001856,
                0.001858,
                0.00186,
                0.001862,
                0.001864,
                0.001866,
                0.001868,
                0.00187,
                0.001872,
                0.001874,
                0.001876,
                0.001878,
                0.00188,
                0.001882,
                0.001884,
                0.001886,
                0.001888,
                0.00189,
                0.001892,
                0.001894,
                0.001896,
                0.001898,
                0.0019,
                0.001902,
                0.001904,
                0.001906,
                0.001908,
                0.00191,
                0.001912,
                0.001914,
                0.001916,
                0.001918,
                0.00192,
                0.001922,
                0.001924,
                0.001926,
                0.001928,
                0.00193,
                0.001932,
                0.001934,
                0.001936,
                0.001938,
                0.00194,
                0.001942,
                0.001944,
                0.001946,
                0.001948,
                0.00195,
                0.001952,
                0.001954,
                0.001956,
                0.001958,
                0.00196,
                0.001962,
                0.001964,
                0.001966,
                0.001968,
                0.00197,
                0.001972,
                0.001974,
                0.001976,
                0.001978,
                0.00198,
                0.001982,
                0.001984,
                0.001986,
                0.001988,
                0.00199,
                0.001992,
                0.001994,
                0.001996,
                0.001998,
                0.002,
            ]
        )

        check_Sig = np.array(
            [
                0.00000000e00,
                4.00000000e-06,
                8.00000000e-06,
                1.20000000e-05,
                1.60000000e-05,
                2.00000000e-05,
                2.40000000e-05,
                2.80000000e-05,
                3.20000000e-05,
                3.60000000e-05,
                4.00000000e-05,
                4.40000000e-05,
                4.80000000e-05,
                5.20000000e-05,
                5.60000000e-05,
                6.00000000e-05,
                6.40000000e-05,
                6.80000000e-05,
                7.20000000e-05,
                7.60000000e-05,
                8.00000000e-05,
                8.40000000e-05,
                8.80000000e-05,
                9.20000000e-05,
                9.60000000e-05,
                1.00000000e-04,
                1.04000000e-04,
                1.08000000e-04,
                1.12000000e-04,
                1.16000000e-04,
                1.20000000e-04,
                1.24000000e-04,
                1.28000000e-04,
                1.32000000e-04,
                1.36000000e-04,
                1.40000000e-04,
                9.93676496e-05,
                1.03367611e-04,
                1.07367573e-04,
                1.11367536e-04,
                1.15367499e-04,
                1.19367463e-04,
                1.23367427e-04,
                1.27367391e-04,
                1.31367357e-04,
                1.35367322e-04,
                1.39367288e-04,
                1.43367255e-04,
                1.47367222e-04,
                1.51367189e-04,
                1.55367157e-04,
                1.59367125e-04,
                1.63367094e-04,
                1.67367063e-04,
                1.71367033e-04,
                1.75367002e-04,
                1.79366973e-04,
                1.83366943e-04,
                1.87366915e-04,
                1.91366886e-04,
                1.95366858e-04,
                1.99366830e-04,
                2.03366802e-04,
                2.07366775e-04,
                2.11366748e-04,
                2.15366722e-04,
                2.19366696e-04,
                2.23366670e-04,
                2.27366645e-04,
                2.31366619e-04,
                2.35366594e-04,
                2.39366570e-04,
                2.43366546e-04,
                2.47366522e-04,
                2.51366498e-04,
                2.55366474e-04,
                2.59366451e-04,
                2.63366429e-04,
                2.67366406e-04,
                2.71366384e-04,
                2.75366362e-04,
                2.79366340e-04,
                2.83366318e-04,
                2.87366297e-04,
                2.91366276e-04,
                2.95366255e-04,
                2.99366234e-04,
                3.03366214e-04,
                3.07366194e-04,
                3.11366174e-04,
                3.15366154e-04,
                3.19366135e-04,
                3.23366116e-04,
                3.27366097e-04,
                3.31366078e-04,
                3.35366059e-04,
                3.39366041e-04,
                3.43366023e-04,
                3.47366005e-04,
                3.51365987e-04,
                3.55365969e-04,
                3.59365952e-04,
                3.63365935e-04,
                3.67365918e-04,
                3.71365901e-04,
                3.75365884e-04,
                3.79365868e-04,
                3.83365851e-04,
                3.70016339e-04,
                3.74016337e-04,
                3.78016335e-04,
                3.82016333e-04,
                3.86016331e-04,
                3.90016329e-04,
                3.94016326e-04,
                3.98016324e-04,
                4.02016322e-04,
                4.06016320e-04,
                4.10016319e-04,
                4.14016317e-04,
                4.18016315e-04,
                4.22016313e-04,
                4.26016311e-04,
                4.30016309e-04,
                4.34016307e-04,
                4.38016305e-04,
                4.42016304e-04,
                4.46016302e-04,
                4.50016300e-04,
                4.54016298e-04,
                4.58016296e-04,
                4.62016295e-04,
                4.66016293e-04,
                4.70016291e-04,
                4.74016290e-04,
                4.78016288e-04,
                4.82016286e-04,
                4.86016285e-04,
                4.90016283e-04,
                4.94016282e-04,
                4.98016280e-04,
                5.02016278e-04,
                5.06016277e-04,
                5.10016275e-04,
                5.14016274e-04,
                5.18016272e-04,
                5.22016271e-04,
                5.26016269e-04,
                5.30016268e-04,
                5.34016266e-04,
                5.38016265e-04,
                5.42016264e-04,
                5.19833975e-04,
                5.23833866e-04,
                5.27833758e-04,
                5.31833650e-04,
                5.35833543e-04,
                5.39833437e-04,
                5.43833332e-04,
                5.47833227e-04,
                5.51833124e-04,
                5.55833021e-04,
                5.59832918e-04,
                5.63832817e-04,
                5.67832716e-04,
                5.71832616e-04,
                5.75832516e-04,
                5.79832418e-04,
                5.83832320e-04,
                5.87832223e-04,
                5.91832126e-04,
                5.95832030e-04,
                5.99831935e-04,
                6.03831840e-04,
                6.07831746e-04,
                6.11831653e-04,
                6.15831560e-04,
                6.19831468e-04,
                6.23831377e-04,
                6.27831286e-04,
                6.31831196e-04,
                6.35831106e-04,
                6.39831018e-04,
                6.43830929e-04,
                6.47830842e-04,
                6.51830755e-04,
                6.55830668e-04,
                6.59830582e-04,
                6.63830496e-04,
                6.67830412e-04,
                6.71830328e-04,
                6.75830244e-04,
                6.79830161e-04,
                6.83830079e-04,
                6.87829996e-04,
                6.91829915e-04,
                6.95829834e-04,
                6.99829754e-04,
                7.03829674e-04,
                7.07829594e-04,
                7.11829516e-04,
                7.15829438e-04,
                7.19829360e-04,
                7.23829282e-04,
                7.27829206e-04,
                7.31829129e-04,
                7.35829054e-04,
                7.39828979e-04,
                7.43828904e-04,
                7.47828830e-04,
                7.51828756e-04,
                7.55828682e-04,
                7.59828610e-04,
                7.38852404e-04,
                7.42852268e-04,
                7.46852134e-04,
                7.50852001e-04,
                7.54851868e-04,
                7.58851736e-04,
                7.62851605e-04,
                7.66851474e-04,
                7.70851345e-04,
                7.74851215e-04,
                7.78851087e-04,
                7.82850960e-04,
                7.86850833e-04,
                7.90850708e-04,
                7.94850582e-04,
                7.98850458e-04,
                8.02850334e-04,
                8.06850211e-04,
                7.81470385e-04,
                7.85470186e-04,
                7.89469989e-04,
                7.93469789e-04,
                7.97469594e-04,
                8.01469401e-04,
                8.05469204e-04,
                8.09469012e-04,
                8.13468822e-04,
                8.17468629e-04,
                8.21468440e-04,
                8.25468253e-04,
                8.29468062e-04,
                8.33467876e-04,
                8.37467693e-04,
                8.41467505e-04,
                8.45467322e-04,
                8.49467141e-04,
                8.53466956e-04,
                8.57466776e-04,
                8.61466598e-04,
                8.65466416e-04,
                8.69466239e-04,
                8.73466064e-04,
                8.77465885e-04,
                8.81465710e-04,
                8.85465538e-04,
                8.89465362e-04,
                8.93465190e-04,
                8.97465021e-04,
                9.01464847e-04,
                9.05464678e-04,
                9.09464511e-04,
                9.13464340e-04,
                5.09356085e-04,
                5.13356080e-04,
                5.17356074e-04,
                5.21356068e-04,
                5.25356063e-04,
                5.29356057e-04,
                5.33356051e-04,
                5.37356046e-04,
                5.41356040e-04,
                5.45356034e-04,
                5.49356029e-04,
                5.53356023e-04,
                5.57356018e-04,
                5.61356012e-04,
                5.65356006e-04,
                5.69356001e-04,
                5.73355995e-04,
                5.77355990e-04,
                5.50003235e-04,
                5.54003225e-04,
                5.58003215e-04,
                5.62003205e-04,
                5.66003195e-04,
                5.70003186e-04,
                3.28369196e-04,
                3.18304022e-04,
                3.22304017e-04,
                3.26304012e-04,
                3.30304007e-04,
                3.34304001e-04,
                3.38303996e-04,
                3.42303991e-04,
                3.46303986e-04,
                3.50303981e-04,
                3.54303975e-04,
                3.58303970e-04,
                3.62303965e-04,
                3.66303960e-04,
                3.70303955e-04,
                3.74303949e-04,
                3.78303944e-04,
                3.82303939e-04,
                3.86303934e-04,
                3.90303929e-04,
                3.94303924e-04,
                3.98303918e-04,
                4.02303913e-04,
                4.06303908e-04,
                4.10303903e-04,
                4.14303898e-04,
                4.18303893e-04,
                4.22303888e-04,
                4.26303883e-04,
                4.30303878e-04,
                4.34303873e-04,
                3.90599404e-04,
                3.94599393e-04,
                3.98599381e-04,
                4.02599370e-04,
                4.06599358e-04,
                4.01540828e-04,
                4.05540815e-04,
                4.09540802e-04,
                4.13540788e-04,
                4.17540775e-04,
                4.21540762e-04,
                4.25540749e-04,
                4.29540736e-04,
                4.33540723e-04,
                4.37540710e-04,
                4.41540697e-04,
                4.45540684e-04,
                3.63797120e-04,
                3.67797117e-04,
                3.71797115e-04,
                3.75797112e-04,
                3.79797109e-04,
                3.83797107e-04,
                3.87797104e-04,
                3.91797102e-04,
                3.95797099e-04,
                3.99797097e-04,
                4.03797094e-04,
                4.07797092e-04,
                4.11797089e-04,
                3.31609537e-04,
                3.35609537e-04,
                3.39609536e-04,
                3.43609535e-04,
                3.47609534e-04,
                3.51609534e-04,
                3.55609533e-04,
                3.59609532e-04,
                3.63609531e-04,
                3.67609531e-04,
                3.71609530e-04,
                3.75609529e-04,
                3.79609528e-04,
                3.83609528e-04,
                3.87609527e-04,
                3.91609526e-04,
                3.95609525e-04,
                3.99609525e-04,
                4.03609524e-04,
                4.07609523e-04,
                4.11609522e-04,
                4.15609522e-04,
                4.19609521e-04,
                4.23609520e-04,
                4.27609519e-04,
                4.31609519e-04,
                4.22163109e-04,
                4.26163108e-04,
                4.30163108e-04,
                4.34163107e-04,
                4.38163107e-04,
                4.42163106e-04,
                4.46163105e-04,
                4.50163105e-04,
                4.54163104e-04,
                4.58163104e-04,
                4.62163103e-04,
                4.66163103e-04,
                4.70163102e-04,
                4.74163102e-04,
                4.78163101e-04,
                4.82163101e-04,
                4.86163100e-04,
                4.90163099e-04,
                4.94163099e-04,
                4.98163098e-04,
                5.02163098e-04,
                5.06163097e-04,
                5.10163097e-04,
                5.14163096e-04,
                5.18163096e-04,
                5.22163095e-04,
                5.26163095e-04,
                5.30163094e-04,
                5.34163094e-04,
                2.89412656e-04,
                2.93412654e-04,
                2.97412651e-04,
                3.01412648e-04,
                3.05412645e-04,
                3.09412642e-04,
                3.13412639e-04,
                3.17412636e-04,
                3.21412633e-04,
                3.25412631e-04,
                3.29412628e-04,
                3.33412625e-04,
                3.37412622e-04,
                3.41412619e-04,
                3.45412616e-04,
                3.49412613e-04,
                3.53412611e-04,
                3.09161911e-04,
                3.13161910e-04,
                3.17161909e-04,
                3.21161908e-04,
                3.25161907e-04,
                3.29161906e-04,
                3.33161905e-04,
                3.37161904e-04,
                3.41161903e-04,
                3.45161902e-04,
                3.49161902e-04,
                3.53161901e-04,
                3.57161900e-04,
                3.61161899e-04,
                3.65161898e-04,
                3.69161897e-04,
                3.73161896e-04,
                3.77161895e-04,
                3.81161894e-04,
                3.85161893e-04,
                3.89161892e-04,
                3.93161891e-04,
                3.97161891e-04,
                4.01161890e-04,
                4.05161889e-04,
                4.09161888e-04,
                4.13161887e-04,
                4.17161886e-04,
                4.21161885e-04,
                4.25161884e-04,
                4.29161883e-04,
                4.33161882e-04,
                4.37161881e-04,
                4.41161880e-04,
                4.45161880e-04,
                4.49161879e-04,
                4.53161878e-04,
                4.57161877e-04,
                4.61161876e-04,
                4.65161875e-04,
                4.69161874e-04,
                4.73161873e-04,
                4.77161872e-04,
                4.81161871e-04,
                4.85161871e-04,
                4.89161870e-04,
                4.93161869e-04,
                4.97161868e-04,
                5.01161867e-04,
                5.05161866e-04,
                5.09161865e-04,
                5.13161864e-04,
                5.17161863e-04,
                5.21161863e-04,
                5.25161862e-04,
                5.29161861e-04,
                5.33161860e-04,
                5.37161859e-04,
                5.41161858e-04,
                5.45161857e-04,
                5.49161856e-04,
                5.53161855e-04,
                5.57161855e-04,
                5.61161854e-04,
                5.65161853e-04,
                5.69161852e-04,
                5.73161851e-04,
                5.77161850e-04,
                5.81161849e-04,
                5.85161848e-04,
                5.89161848e-04,
                5.93161847e-04,
                5.97161846e-04,
                6.01161845e-04,
                6.05161844e-04,
                6.09161843e-04,
                6.13161842e-04,
                6.17161841e-04,
                5.25573503e-04,
                5.29573494e-04,
                5.33573485e-04,
                5.37573476e-04,
                5.41573467e-04,
                5.45573458e-04,
                5.49573449e-04,
                5.53573441e-04,
                5.57573432e-04,
                5.61573423e-04,
                5.65573414e-04,
                5.69573405e-04,
                5.73573396e-04,
                5.77573387e-04,
                5.81573378e-04,
                5.85573370e-04,
                5.89573361e-04,
                5.93573352e-04,
                5.97573343e-04,
                6.01573334e-04,
                6.05573325e-04,
                6.09573317e-04,
                6.13573308e-04,
                6.17573299e-04,
                6.21573290e-04,
                6.25573281e-04,
                6.29573273e-04,
                6.33573264e-04,
                6.37573255e-04,
                6.41573246e-04,
                6.45573238e-04,
                6.49573229e-04,
                6.53573220e-04,
                6.57573211e-04,
                6.61573203e-04,
                6.65573194e-04,
                6.69573185e-04,
                6.73573176e-04,
                6.77573168e-04,
                6.81573159e-04,
                6.85573150e-04,
                5.81300531e-04,
                5.85300527e-04,
                5.89300523e-04,
                5.93300519e-04,
                5.97300515e-04,
                6.01300511e-04,
                6.05300507e-04,
                6.09300503e-04,
                6.13300499e-04,
                6.17300495e-04,
                6.21300491e-04,
                6.25300487e-04,
                6.29300483e-04,
                6.33300479e-04,
                6.37300475e-04,
                6.41300471e-04,
                6.45300467e-04,
                6.49300463e-04,
                6.53300459e-04,
                6.14167092e-04,
                6.18167090e-04,
                6.22167088e-04,
                6.26167085e-04,
                3.22119883e-04,
                3.26119882e-04,
                3.30119881e-04,
                3.34119881e-04,
                3.38119880e-04,
                3.42119879e-04,
                3.46119878e-04,
                3.50119877e-04,
                2.91749201e-04,
                2.95749198e-04,
                2.99749196e-04,
                3.03749194e-04,
                3.07749191e-04,
                3.11749189e-04,
                3.15749187e-04,
                3.19749184e-04,
                3.23749182e-04,
                3.27749179e-04,
                3.31749177e-04,
                3.35749175e-04,
                3.39749172e-04,
                3.43749170e-04,
                3.47749168e-04,
                3.51749165e-04,
                3.55749163e-04,
                3.59749161e-04,
                3.63749158e-04,
                3.67749156e-04,
                3.71749154e-04,
                3.75749151e-04,
                3.79749149e-04,
                3.83749147e-04,
                3.87749144e-04,
                3.91749142e-04,
                3.95749140e-04,
                3.99749137e-04,
                4.03749135e-04,
                4.07749133e-04,
                4.11749130e-04,
                4.15749128e-04,
                4.19749126e-04,
                4.23749123e-04,
                4.27749121e-04,
                4.31749119e-04,
                4.35749116e-04,
                4.39749114e-04,
                4.43749112e-04,
                4.47749110e-04,
                4.51749107e-04,
                4.55749105e-04,
                4.59749103e-04,
                4.63749100e-04,
                4.67749098e-04,
                4.71749096e-04,
                4.75749093e-04,
                4.79749091e-04,
                4.44421240e-04,
                4.48421236e-04,
                4.52421232e-04,
                4.56421228e-04,
                4.60421224e-04,
                4.64421220e-04,
                4.68421217e-04,
                4.72421213e-04,
                4.76421209e-04,
                4.80421205e-04,
                4.84421201e-04,
                4.88421197e-04,
                4.92421193e-04,
                4.96421189e-04,
                5.00421186e-04,
                5.04421182e-04,
                5.08421178e-04,
                5.12421174e-04,
                5.16421170e-04,
                5.20421166e-04,
                5.24421162e-04,
                5.28421159e-04,
                5.32421155e-04,
                5.36421151e-04,
                5.24859789e-04,
                5.28859783e-04,
                5.32859777e-04,
                5.36859771e-04,
                5.40859765e-04,
                5.44859759e-04,
                5.48859753e-04,
                5.52859747e-04,
                5.56859741e-04,
                3.04953287e-04,
                3.08953284e-04,
                3.12953282e-04,
                3.16953280e-04,
                3.20953278e-04,
                3.24953276e-04,
                3.28953274e-04,
                3.32953272e-04,
                3.36953270e-04,
                3.40953267e-04,
                3.44953265e-04,
                3.48953263e-04,
                3.52953261e-04,
                3.56953259e-04,
                3.60953257e-04,
                3.64953255e-04,
                3.68953253e-04,
                3.72953251e-04,
                3.76953248e-04,
                3.80953246e-04,
                3.84953244e-04,
                3.88953242e-04,
                3.92953240e-04,
                3.96953238e-04,
                4.00953236e-04,
                4.04953234e-04,
                4.08953232e-04,
                4.12953230e-04,
                4.16953227e-04,
                4.20953225e-04,
                4.24953223e-04,
                4.28953221e-04,
                4.32953219e-04,
                4.36953217e-04,
                4.40953215e-04,
                4.44953213e-04,
                4.48953211e-04,
                4.52953209e-04,
                4.56953207e-04,
                4.60953204e-04,
                4.64953202e-04,
                4.68953200e-04,
                4.72953198e-04,
                4.76953196e-04,
                4.80953194e-04,
                4.84953192e-04,
                4.88953190e-04,
                4.49828910e-04,
                4.53828907e-04,
                4.57828903e-04,
                4.61828900e-04,
                4.65828897e-04,
                4.69828893e-04,
                4.73828890e-04,
                4.77828887e-04,
                4.81828884e-04,
                4.85828880e-04,
                4.89828877e-04,
                4.93828874e-04,
                4.97828870e-04,
                5.01828867e-04,
                5.05828864e-04,
                5.09828861e-04,
                5.13828857e-04,
                5.17828854e-04,
                5.21828851e-04,
                5.25828847e-04,
                5.29828844e-04,
                5.33828841e-04,
                5.08436582e-04,
                5.12436579e-04,
                5.16436577e-04,
                5.20436575e-04,
                5.24436572e-04,
                5.28436570e-04,
                5.32436567e-04,
                5.36436565e-04,
                5.40436562e-04,
                5.44436560e-04,
                5.48436557e-04,
                5.52436555e-04,
                5.56436553e-04,
                5.60436550e-04,
                5.64436548e-04,
                5.68436545e-04,
                5.19587585e-04,
                5.23587583e-04,
                5.27587582e-04,
                5.31587580e-04,
                5.35587579e-04,
                5.39587578e-04,
                5.43587576e-04,
                5.47587575e-04,
                5.51587573e-04,
                5.55587572e-04,
                5.59587571e-04,
                5.63587569e-04,
                5.67587568e-04,
                5.71587567e-04,
                5.75587565e-04,
                5.79587564e-04,
                5.83587562e-04,
                5.87587561e-04,
                5.91587560e-04,
                5.95587558e-04,
                5.78932639e-04,
                5.82932639e-04,
                5.86932638e-04,
                5.90932638e-04,
                5.94932637e-04,
                5.98932637e-04,
                6.02932636e-04,
                6.06932636e-04,
                6.10932635e-04,
                6.14932634e-04,
                6.18932634e-04,
                6.22932633e-04,
                6.26932633e-04,
                6.30932632e-04,
                6.34932632e-04,
                6.38932631e-04,
                6.42932631e-04,
                6.46932630e-04,
                6.50932630e-04,
                6.54932629e-04,
                6.58932629e-04,
                6.62932628e-04,
                6.66932628e-04,
                6.70932627e-04,
                6.74932627e-04,
                6.78932626e-04,
                6.82932626e-04,
                6.86932625e-04,
                6.90932625e-04,
                6.94932624e-04,
                6.98932624e-04,
                7.02932623e-04,
                7.06932623e-04,
                7.10932622e-04,
                7.14932622e-04,
                7.18932621e-04,
                7.22932621e-04,
                7.26932620e-04,
                7.30932620e-04,
                7.34932619e-04,
                7.38932619e-04,
                7.42932618e-04,
                7.46932618e-04,
                7.50932617e-04,
                7.54932617e-04,
                7.58932616e-04,
                7.62932616e-04,
                7.66932615e-04,
                7.70932615e-04,
                7.74932614e-04,
                7.78932614e-04,
                7.82932613e-04,
                3.07008210e-04,
                3.11008210e-04,
                3.15008209e-04,
                3.19008209e-04,
                3.23008209e-04,
                3.27008208e-04,
                3.31008208e-04,
                3.35008208e-04,
                3.39008208e-04,
                3.43008207e-04,
                3.47008207e-04,
                3.51008207e-04,
                3.55008206e-04,
                3.59008206e-04,
                3.63008206e-04,
                3.67008206e-04,
                3.71008205e-04,
                3.75008205e-04,
                3.79008205e-04,
                3.83008204e-04,
                3.87008204e-04,
                3.91008204e-04,
                3.37123408e-04,
                3.41123407e-04,
                3.45123407e-04,
                3.49123406e-04,
                3.53123406e-04,
                3.57123405e-04,
                3.61123405e-04,
                3.65123404e-04,
                3.55136015e-04,
                3.59136015e-04,
                3.63136015e-04,
                3.67136014e-04,
                3.71136014e-04,
                3.24783467e-04,
                3.28783466e-04,
                3.32783465e-04,
                3.36783464e-04,
                3.40783462e-04,
                3.44783461e-04,
                3.48783460e-04,
                3.52783459e-04,
                3.56783457e-04,
                3.60783456e-04,
                3.64783455e-04,
                3.68783454e-04,
                2.87281627e-04,
                2.91281626e-04,
                2.95281625e-04,
                2.99281624e-04,
                3.03281623e-04,
                3.07281622e-04,
                3.11281621e-04,
                3.15281619e-04,
                3.19281618e-04,
                3.23281617e-04,
                3.27281616e-04,
                3.31281615e-04,
                3.35281614e-04,
                3.39281613e-04,
                3.43281611e-04,
                3.47281610e-04,
                3.51281609e-04,
                3.55281608e-04,
                3.59281607e-04,
                3.63281606e-04,
                3.50711143e-04,
                3.54711141e-04,
                3.58711139e-04,
                3.62711138e-04,
                3.66711136e-04,
                3.70711134e-04,
                3.74711133e-04,
                3.78711131e-04,
                3.82711129e-04,
                3.86711127e-04,
                3.90711126e-04,
                3.94711124e-04,
                3.98711122e-04,
                4.02711120e-04,
                3.83370253e-04,
                3.87370250e-04,
                3.91370248e-04,
                3.95370245e-04,
                3.99370242e-04,
                4.03370240e-04,
                4.07370237e-04,
                4.11370235e-04,
                4.15370232e-04,
                4.19370229e-04,
                4.23370227e-04,
                4.27370224e-04,
                4.31370222e-04,
                4.35370219e-04,
                4.39370216e-04,
                4.43370214e-04,
                4.23161609e-04,
                4.27161607e-04,
                4.31161605e-04,
                4.35161602e-04,
                4.39161600e-04,
                4.43161598e-04,
                4.47161596e-04,
                4.51161593e-04,
                4.55161591e-04,
                4.59161589e-04,
                4.63161586e-04,
                4.67161584e-04,
                4.71161582e-04,
                4.75161580e-04,
                4.79161577e-04,
                4.27967533e-04,
                4.31967533e-04,
                4.35967532e-04,
                4.39967532e-04,
                4.43967531e-04,
                4.47967531e-04,
                4.51967530e-04,
                4.55967530e-04,
                4.59967530e-04,
                4.63967529e-04,
                4.67967529e-04,
                4.71967528e-04,
                4.75967528e-04,
                4.79967528e-04,
                4.83967527e-04,
                4.87967527e-04,
                4.91967526e-04,
                4.95967526e-04,
                4.99967526e-04,
                5.03967525e-04,
                3.79897538e-04,
                3.83897538e-04,
                3.87897537e-04,
                3.91897537e-04,
                3.95897536e-04,
                3.99897536e-04,
                4.03897535e-04,
                4.07897535e-04,
                4.11897534e-04,
                3.89119255e-04,
                3.93119254e-04,
                3.97119253e-04,
                4.01119252e-04,
                4.05119251e-04,
                4.09119250e-04,
                4.13119249e-04,
                4.17119248e-04,
                4.21119247e-04,
                4.25119246e-04,
                4.29119245e-04,
                4.33119244e-04,
                4.37119243e-04,
                4.18256707e-04,
                4.22256705e-04,
                4.26256703e-04,
                4.30256702e-04,
                4.34256700e-04,
                4.38256698e-04,
                4.42256696e-04,
                4.46256695e-04,
                4.50256693e-04,
                4.54256691e-04,
                4.58256690e-04,
                4.62256688e-04,
                4.66256686e-04,
                4.70256684e-04,
                4.74256683e-04,
                4.78256681e-04,
                4.82256679e-04,
                4.86256678e-04,
                4.90256676e-04,
                4.94256674e-04,
                4.98256673e-04,
                5.02256671e-04,
                5.06256669e-04,
                5.10256667e-04,
                5.14256666e-04,
                5.18256664e-04,
                5.22256662e-04,
                5.26256661e-04,
                5.30256659e-04,
                5.34256657e-04,
                5.38256656e-04,
                5.42256654e-04,
                5.46256652e-04,
                5.50256650e-04,
                5.54256649e-04,
                5.58256647e-04,
                5.62256645e-04,
            ]
        )

        check_Sig_plastic = np.array(
            [
                0.00000000e00,
                4.00000000e-06,
                8.00000000e-06,
                1.20000000e-05,
                1.60000000e-05,
                2.00000000e-05,
                2.40000000e-05,
                2.80000000e-05,
                3.20000000e-05,
                3.60000000e-05,
                4.00000000e-05,
                4.40000000e-05,
                4.80000000e-05,
                5.20000000e-05,
                5.60000000e-05,
                6.00000000e-05,
                6.40000000e-05,
                6.80000000e-05,
                7.20000000e-05,
                7.60000000e-05,
                8.00000000e-05,
                8.40000000e-05,
                8.80000000e-05,
                9.20000000e-05,
                9.60000000e-05,
                1.00000000e-04,
                1.04000000e-04,
                1.08000000e-04,
                1.12000000e-04,
                1.16000000e-04,
                1.20000000e-04,
                1.24000000e-04,
                1.28000000e-04,
                1.32000000e-04,
                1.36000000e-04,
                1.40000000e-04,
                9.93655424e-05,
                1.03366836e-04,
                1.07367244e-04,
                1.11367382e-04,
                1.15367413e-04,
                1.19367403e-04,
                1.23367379e-04,
                1.27367348e-04,
                1.31367316e-04,
                1.35367282e-04,
                1.39367249e-04,
                1.43367216e-04,
                1.47367183e-04,
                1.51367150e-04,
                1.55367118e-04,
                1.59367086e-04,
                1.63367054e-04,
                1.67367023e-04,
                1.71366993e-04,
                1.75366962e-04,
                1.79366932e-04,
                1.83366902e-04,
                1.87366872e-04,
                1.91366842e-04,
                1.95366814e-04,
                1.99366786e-04,
                2.03366749e-04,
                2.07366712e-04,
                2.11366682e-04,
                2.15366652e-04,
                2.19366624e-04,
                2.23366596e-04,
                2.27366569e-04,
                2.31366542e-04,
                2.35366516e-04,
                2.39366491e-04,
                2.43366465e-04,
                2.47366440e-04,
                2.51366416e-04,
                2.55366391e-04,
                2.59366367e-04,
                2.63366342e-04,
                2.67366318e-04,
                2.71366293e-04,
                2.75366271e-04,
                2.79366244e-04,
                2.83366221e-04,
                2.87366199e-04,
                2.91366177e-04,
                2.95366157e-04,
                2.99366137e-04,
                3.03366117e-04,
                3.07366098e-04,
                3.11366079e-04,
                3.15366060e-04,
                3.19366041e-04,
                3.23366023e-04,
                3.27366005e-04,
                3.31365987e-04,
                3.35365970e-04,
                3.39365906e-04,
                3.43365843e-04,
                3.47365773e-04,
                3.51365735e-04,
                3.55365691e-04,
                3.59365658e-04,
                3.63365625e-04,
                3.67365599e-04,
                3.71365571e-04,
                3.75365549e-04,
                3.79365525e-04,
                3.83365506e-04,
                3.70009779e-04,
                3.74010016e-04,
                3.78010239e-04,
                3.82010450e-04,
                3.86010640e-04,
                3.90010821e-04,
                3.94010995e-04,
                3.98011161e-04,
                4.02011313e-04,
                4.06011459e-04,
                4.10011591e-04,
                4.14011720e-04,
                4.18011845e-04,
                4.22011965e-04,
                4.26012075e-04,
                4.30012183e-04,
                4.34012287e-04,
                4.38012381e-04,
                4.42012474e-04,
                4.46012564e-04,
                4.50012646e-04,
                4.54012726e-04,
                4.58012804e-04,
                4.62012881e-04,
                4.66012955e-04,
                4.70013023e-04,
                4.74013090e-04,
                4.78013155e-04,
                4.82013218e-04,
                4.86013276e-04,
                4.90013332e-04,
                4.94013388e-04,
                4.98013442e-04,
                5.02013495e-04,
                5.06013543e-04,
                5.10013591e-04,
                5.14013637e-04,
                5.18013683e-04,
                5.22013728e-04,
                5.26013768e-04,
                5.30013811e-04,
                5.34013850e-04,
                5.38013889e-04,
                5.42013926e-04,
                5.19824777e-04,
                5.23827613e-04,
                5.27829488e-04,
                5.31830759e-04,
                5.35831501e-04,
                5.39831977e-04,
                5.43832240e-04,
                5.47832378e-04,
                5.51832437e-04,
                5.55832435e-04,
                5.59832404e-04,
                5.63832343e-04,
                5.67832273e-04,
                5.71832180e-04,
                5.75832109e-04,
                5.79832010e-04,
                5.83831915e-04,
                5.87831817e-04,
                5.91831722e-04,
                5.95831629e-04,
                5.99831536e-04,
                6.03831444e-04,
                6.07831352e-04,
                6.11831262e-04,
                6.15831171e-04,
                6.19831082e-04,
                6.23830993e-04,
                6.27830905e-04,
                6.31830818e-04,
                6.35830731e-04,
                6.39830645e-04,
                6.43830559e-04,
                6.47830474e-04,
                6.51830389e-04,
                6.55830305e-04,
                6.59830222e-04,
                6.63829936e-04,
                6.67829896e-04,
                6.71829834e-04,
                6.75829786e-04,
                6.79829730e-04,
                6.83829672e-04,
                6.87829400e-04,
                6.91829377e-04,
                6.95829326e-04,
                6.99829287e-04,
                7.03829239e-04,
                7.07828976e-04,
                7.11828970e-04,
                7.15828928e-04,
                7.19828896e-04,
                7.23828639e-04,
                7.27828378e-04,
                7.31828090e-04,
                7.35827927e-04,
                7.39827750e-04,
                7.43827611e-04,
                7.47827484e-04,
                7.51827366e-04,
                7.55827255e-04,
                7.59827151e-04,
                7.38839580e-04,
                7.42840813e-04,
                7.46843254e-04,
                7.50845043e-04,
                7.54846467e-04,
                7.58847538e-04,
                7.62848305e-04,
                7.66848851e-04,
                7.70849230e-04,
                7.74849027e-04,
                7.78849300e-04,
                7.82849404e-04,
                7.86849490e-04,
                7.90849524e-04,
                7.94849169e-04,
                7.98848753e-04,
                8.02848374e-04,
                8.06848103e-04,
                7.81456786e-04,
                7.85457075e-04,
                7.89456426e-04,
                7.93459807e-04,
                7.97459780e-04,
                8.01458850e-04,
                8.05461675e-04,
                8.09461417e-04,
                8.13460351e-04,
                8.17462699e-04,
                8.21462286e-04,
                8.25461137e-04,
                8.29463192e-04,
                8.33462682e-04,
                8.37461500e-04,
                8.41463349e-04,
                8.45462780e-04,
                8.49461576e-04,
                8.53463256e-04,
                8.57462662e-04,
                8.61461447e-04,
                8.65463042e-04,
                8.69462429e-04,
                8.73461208e-04,
                8.77462740e-04,
                8.81462118e-04,
                8.85460893e-04,
                8.89462381e-04,
                8.93461756e-04,
                8.97460548e-04,
                9.01461990e-04,
                9.05461367e-04,
                9.09460158e-04,
                9.13461577e-04,
                5.09347245e-04,
                5.13347458e-04,
                5.17347682e-04,
                5.21347915e-04,
                5.25348142e-04,
                5.29348378e-04,
                5.33348594e-04,
                5.37348805e-04,
                5.41349011e-04,
                5.45349198e-04,
                5.49349381e-04,
                5.53349560e-04,
                5.57349734e-04,
                5.61349892e-04,
                5.65350046e-04,
                5.69350197e-04,
                5.73350343e-04,
                5.77350476e-04,
                5.49994009e-04,
                5.53994208e-04,
                5.57994456e-04,
                5.61994735e-04,
                5.65995008e-04,
                5.69995274e-04,
                3.28363712e-04,
                3.18298499e-04,
                3.22298670e-04,
                3.26298876e-04,
                3.30299081e-04,
                3.34299274e-04,
                3.38299458e-04,
                3.42299632e-04,
                3.46299797e-04,
                3.50299946e-04,
                3.54300088e-04,
                3.58300224e-04,
                3.62300355e-04,
                3.66300472e-04,
                3.70300585e-04,
                3.74300693e-04,
                3.78300797e-04,
                3.82300891e-04,
                3.86300981e-04,
                3.90301068e-04,
                3.94301151e-04,
                3.98301232e-04,
                4.02301304e-04,
                4.06301373e-04,
                4.10301440e-04,
                4.14301505e-04,
                4.18301568e-04,
                4.22301628e-04,
                4.26301682e-04,
                4.30301734e-04,
                4.34301784e-04,
                3.90592374e-04,
                3.94592540e-04,
                3.98592760e-04,
                4.02593003e-04,
                4.06593241e-04,
                4.01533850e-04,
                4.05533967e-04,
                4.09534178e-04,
                4.13534426e-04,
                4.17534690e-04,
                4.21534947e-04,
                4.25535195e-04,
                4.29535431e-04,
                4.33535643e-04,
                4.37535844e-04,
                4.41536036e-04,
                4.45536217e-04,
                3.63790971e-04,
                3.67791109e-04,
                3.71791269e-04,
                3.75791441e-04,
                3.79791603e-04,
                3.83791765e-04,
                3.87791916e-04,
                3.91792065e-04,
                3.95792211e-04,
                3.99792346e-04,
                4.03792478e-04,
                4.07792600e-04,
                4.11792718e-04,
                3.31603846e-04,
                3.35603964e-04,
                3.39604083e-04,
                3.43604194e-04,
                3.47604312e-04,
                3.51604422e-04,
                3.55604530e-04,
                3.59604638e-04,
                3.63604737e-04,
                3.67604834e-04,
                3.71604931e-04,
                3.75605025e-04,
                3.79605112e-04,
                3.83605198e-04,
                3.87605282e-04,
                3.91605360e-04,
                3.95605436e-04,
                3.99605510e-04,
                4.03605584e-04,
                4.07605656e-04,
                4.11605722e-04,
                4.15605787e-04,
                4.19605850e-04,
                4.23605913e-04,
                4.27605975e-04,
                4.31606031e-04,
                4.22156058e-04,
                4.26156198e-04,
                4.30156315e-04,
                4.34156426e-04,
                4.38156537e-04,
                4.42156641e-04,
                4.46156744e-04,
                4.50156847e-04,
                4.54156950e-04,
                4.58157044e-04,
                4.62157137e-04,
                4.66157229e-04,
                4.70157320e-04,
                4.74157403e-04,
                4.78157485e-04,
                4.82157566e-04,
                4.86157647e-04,
                4.90157726e-04,
                4.94157797e-04,
                4.98157868e-04,
                5.02157938e-04,
                5.06158006e-04,
                5.10158074e-04,
                5.14158141e-04,
                5.18158202e-04,
                5.22158267e-04,
                5.26158326e-04,
                5.30158384e-04,
                5.34158441e-04,
                2.89407376e-04,
                2.93407560e-04,
                2.97407756e-04,
                3.01407953e-04,
                3.05408132e-04,
                3.09408303e-04,
                3.13408458e-04,
                3.17408608e-04,
                3.21408744e-04,
                3.25408875e-04,
                3.29409001e-04,
                3.33409115e-04,
                3.37409226e-04,
                3.41409332e-04,
                3.45409429e-04,
                3.49409523e-04,
                3.53409614e-04,
                3.09156438e-04,
                3.13156606e-04,
                3.17156763e-04,
                3.21156912e-04,
                3.25157052e-04,
                3.29157186e-04,
                3.33157306e-04,
                3.37157422e-04,
                3.41157534e-04,
                3.45157635e-04,
                3.49157733e-04,
                3.53157829e-04,
                3.57157915e-04,
                3.61158000e-04,
                3.65158083e-04,
                3.69158164e-04,
                3.73158237e-04,
                3.77158309e-04,
                3.81158380e-04,
                3.85158449e-04,
                3.89158512e-04,
                3.93158573e-04,
                3.97158634e-04,
                4.01158693e-04,
                4.05158751e-04,
                4.09158808e-04,
                4.13158860e-04,
                4.17158911e-04,
                4.21158961e-04,
                4.25159010e-04,
                4.29159059e-04,
                4.33159106e-04,
                4.37159149e-04,
                4.41159191e-04,
                4.45159236e-04,
                4.49159277e-04,
                4.53159317e-04,
                4.57159357e-04,
                4.61159395e-04,
                4.65159430e-04,
                4.69159468e-04,
                4.73159502e-04,
                4.77159535e-04,
                4.81159568e-04,
                4.85159600e-04,
                4.89159632e-04,
                4.93159663e-04,
                4.97159694e-04,
                5.01159725e-04,
                5.05159752e-04,
                5.09159782e-04,
                5.13159808e-04,
                5.17159834e-04,
                5.21159860e-04,
                5.25159885e-04,
                5.29159910e-04,
                5.33159934e-04,
                5.37159959e-04,
                5.41159983e-04,
                5.45160004e-04,
                5.49160027e-04,
                5.53160048e-04,
                5.57160071e-04,
                5.61160091e-04,
                5.65160110e-04,
                5.69160130e-04,
                5.73160149e-04,
                5.77160168e-04,
                5.81160187e-04,
                5.85160206e-04,
                5.89160224e-04,
                5.93160240e-04,
                5.97160258e-04,
                6.01160274e-04,
                6.05160291e-04,
                6.09160306e-04,
                6.13160321e-04,
                6.17160336e-04,
                5.25563782e-04,
                5.29564029e-04,
                5.33564300e-04,
                5.37564594e-04,
                5.41564892e-04,
                5.45565194e-04,
                5.49565482e-04,
                5.53565743e-04,
                5.57565994e-04,
                5.61566235e-04,
                5.65566468e-04,
                5.69566693e-04,
                5.73566896e-04,
                5.77567092e-04,
                5.81567282e-04,
                5.85567465e-04,
                5.89567642e-04,
                5.93567812e-04,
                5.97567966e-04,
                6.01568114e-04,
                6.05568258e-04,
                6.09568397e-04,
                6.13568531e-04,
                6.17568661e-04,
                6.21568786e-04,
                6.25568907e-04,
                6.29569014e-04,
                6.33569118e-04,
                6.37569219e-04,
                6.41569316e-04,
                6.45569410e-04,
                6.49569501e-04,
                6.53569589e-04,
                6.57569674e-04,
                6.61569756e-04,
                6.65569828e-04,
                6.69569905e-04,
                6.73569972e-04,
                6.77570037e-04,
                6.81570099e-04,
                6.85570160e-04,
                5.81290468e-04,
                5.85290680e-04,
                5.89290906e-04,
                5.93291130e-04,
                5.97291366e-04,
                6.01291599e-04,
                6.05291815e-04,
                6.09292040e-04,
                6.13292248e-04,
                6.17292451e-04,
                6.21292651e-04,
                6.25292834e-04,
                6.29293013e-04,
                6.33293188e-04,
                6.37293360e-04,
                6.41293528e-04,
                6.45293681e-04,
                6.49293831e-04,
                6.53293977e-04,
                6.14156477e-04,
                6.18156728e-04,
                6.22156968e-04,
                6.26157216e-04,
                3.22114493e-04,
                3.26114598e-04,
                3.30114706e-04,
                3.34114816e-04,
                3.38114928e-04,
                3.42115034e-04,
                3.46115139e-04,
                3.50115238e-04,
                2.91744057e-04,
                2.95744163e-04,
                2.99744294e-04,
                3.03744435e-04,
                3.07744576e-04,
                3.11744717e-04,
                3.15744856e-04,
                3.19744992e-04,
                3.23745126e-04,
                3.27745250e-04,
                3.31745371e-04,
                3.35745488e-04,
                3.39745602e-04,
                3.43745707e-04,
                3.47745809e-04,
                3.51745908e-04,
                3.55746004e-04,
                3.59746091e-04,
                3.63746176e-04,
                3.67746259e-04,
                3.71746339e-04,
                3.75746417e-04,
                3.79746488e-04,
                3.83746562e-04,
                3.87746628e-04,
                3.91746693e-04,
                3.95746756e-04,
                3.99746817e-04,
                4.03746872e-04,
                4.07746930e-04,
                4.11746982e-04,
                4.15747033e-04,
                4.19747083e-04,
                4.23747131e-04,
                4.27747177e-04,
                4.31747223e-04,
                4.35747263e-04,
                4.39747303e-04,
                4.43747341e-04,
                4.47747379e-04,
                4.51747416e-04,
                4.55747451e-04,
                4.59747486e-04,
                4.63747520e-04,
                4.67747550e-04,
                4.71747582e-04,
                4.75747610e-04,
                4.79747638e-04,
                4.44413514e-04,
                4.48413707e-04,
                4.52413903e-04,
                4.56414114e-04,
                4.60414325e-04,
                4.64414527e-04,
                4.68414719e-04,
                4.72414904e-04,
                4.76415082e-04,
                4.80415254e-04,
                4.84415420e-04,
                4.88415571e-04,
                4.92415717e-04,
                4.96415860e-04,
                5.00415999e-04,
                5.04416133e-04,
                5.08416256e-04,
                5.12416375e-04,
                5.16416492e-04,
                5.20416605e-04,
                5.24416716e-04,
                5.28416824e-04,
                5.32416928e-04,
                5.36417023e-04,
                5.24851165e-04,
                5.28851285e-04,
                5.32851438e-04,
                5.36851625e-04,
                5.40851831e-04,
                5.44852039e-04,
                5.48852261e-04,
                5.52852467e-04,
                5.56852683e-04,
                3.04947868e-04,
                3.08947987e-04,
                3.12948119e-04,
                3.16948261e-04,
                3.20948413e-04,
                3.24948556e-04,
                3.28948698e-04,
                3.32948837e-04,
                3.36948967e-04,
                3.40949094e-04,
                3.44949217e-04,
                3.48949331e-04,
                3.52949442e-04,
                3.56949550e-04,
                3.60949656e-04,
                3.64949752e-04,
                3.68949846e-04,
                3.72949937e-04,
                3.76950026e-04,
                3.80950107e-04,
                3.84950191e-04,
                3.88950268e-04,
                3.92950342e-04,
                3.96950415e-04,
                4.00950480e-04,
                4.04950549e-04,
                4.08950612e-04,
                4.12950672e-04,
                4.16950732e-04,
                4.20950789e-04,
                4.24950846e-04,
                4.28950896e-04,
                4.32950950e-04,
                4.36950998e-04,
                4.40951045e-04,
                4.44951091e-04,
                4.48951136e-04,
                4.52951179e-04,
                4.56951218e-04,
                4.60951260e-04,
                4.64951297e-04,
                4.68951333e-04,
                4.72951369e-04,
                4.76951404e-04,
                4.80951437e-04,
                4.84951471e-04,
                4.88951503e-04,
                4.49820592e-04,
                4.53820863e-04,
                4.57821101e-04,
                4.61821327e-04,
                4.65821555e-04,
                4.69821773e-04,
                4.73821981e-04,
                4.77822170e-04,
                4.81822353e-04,
                4.85822530e-04,
                4.89822701e-04,
                4.93822868e-04,
                4.97823019e-04,
                5.01823167e-04,
                5.05823310e-04,
                5.09823450e-04,
                5.13823586e-04,
                5.17823710e-04,
                5.21823831e-04,
                5.25823949e-04,
                5.29824064e-04,
                5.33824177e-04,
                5.08427785e-04,
                5.12428017e-04,
                5.16428249e-04,
                5.20428484e-04,
                5.24428719e-04,
                5.28428941e-04,
                5.32429152e-04,
                5.36429354e-04,
                5.40429535e-04,
                5.44429709e-04,
                5.48429877e-04,
                5.52430040e-04,
                5.56430198e-04,
                5.60430350e-04,
                5.64430489e-04,
                5.68430623e-04,
                5.19578800e-04,
                5.23578986e-04,
                5.27579156e-04,
                5.31579322e-04,
                5.35579485e-04,
                5.39579645e-04,
                5.43579801e-04,
                5.47579954e-04,
                5.51580104e-04,
                5.55580241e-04,
                5.59580375e-04,
                5.63580507e-04,
                5.67580636e-04,
                5.71580763e-04,
                5.75580888e-04,
                5.79581002e-04,
                5.83581114e-04,
                5.87581224e-04,
                5.91581332e-04,
                5.95581438e-04,
                5.78922783e-04,
                5.82923005e-04,
                5.86923187e-04,
                5.90923355e-04,
                5.94923510e-04,
                5.98923652e-04,
                6.02923782e-04,
                6.06923911e-04,
                6.10924028e-04,
                6.14924144e-04,
                6.18924258e-04,
                6.22924371e-04,
                6.26924473e-04,
                6.30924574e-04,
                6.34924674e-04,
                6.38924773e-04,
                6.42924871e-04,
                6.46924959e-04,
                6.50925045e-04,
                6.54925131e-04,
                6.58925216e-04,
                6.62925300e-04,
                6.66925383e-04,
                6.70925465e-04,
                6.74925538e-04,
                6.78925611e-04,
                6.82925683e-04,
                6.86925754e-04,
                6.90925824e-04,
                6.94925893e-04,
                6.98925962e-04,
                7.02926030e-04,
                7.06926097e-04,
                7.10926164e-04,
                7.14926230e-04,
                7.18926295e-04,
                7.22926359e-04,
                7.26926423e-04,
                7.30926486e-04,
                7.34926549e-04,
                7.38926610e-04,
                7.42926671e-04,
                7.46926731e-04,
                7.50926791e-04,
                7.54926850e-04,
                7.58926908e-04,
                7.62926966e-04,
                7.66927023e-04,
                7.70927080e-04,
                7.74927136e-04,
                7.78927191e-04,
                7.82927245e-04,
                3.07003046e-04,
                3.11003150e-04,
                3.15003249e-04,
                3.19003343e-04,
                3.23003431e-04,
                3.27003513e-04,
                3.31003594e-04,
                3.35003670e-04,
                3.39003745e-04,
                3.43003815e-04,
                3.47003883e-04,
                3.51003946e-04,
                3.55004008e-04,
                3.59004065e-04,
                3.63004122e-04,
                3.67004177e-04,
                3.71004228e-04,
                3.75004278e-04,
                3.79004328e-04,
                3.83004377e-04,
                3.87004426e-04,
                3.91004470e-04,
                3.37117714e-04,
                3.41117834e-04,
                3.45117944e-04,
                3.49118054e-04,
                3.53118161e-04,
                3.57118261e-04,
                3.61118359e-04,
                3.65118455e-04,
                3.55130076e-04,
                3.59130208e-04,
                3.63130328e-04,
                3.67130453e-04,
                3.71130575e-04,
                3.24777675e-04,
                3.28777796e-04,
                3.32777920e-04,
                3.36778045e-04,
                3.40778163e-04,
                3.44778281e-04,
                3.48778399e-04,
                3.52778515e-04,
                3.56778630e-04,
                3.60778737e-04,
                3.64778842e-04,
                3.68778946e-04,
                2.87276446e-04,
                2.91276578e-04,
                2.95276711e-04,
                2.99276843e-04,
                3.03276967e-04,
                3.07277090e-04,
                3.11277211e-04,
                3.15277323e-04,
                3.19277433e-04,
                3.23277541e-04,
                3.27277646e-04,
                3.31277743e-04,
                3.35277839e-04,
                3.39277932e-04,
                3.43278017e-04,
                3.47278100e-04,
                3.51278182e-04,
                3.55278262e-04,
                3.59278335e-04,
                3.63278407e-04,
                3.50704853e-04,
                3.54705011e-04,
                3.58705163e-04,
                3.62705330e-04,
                3.66705499e-04,
                3.70705662e-04,
                3.74705819e-04,
                3.78705969e-04,
                3.82706114e-04,
                3.86706254e-04,
                3.90706389e-04,
                3.94706512e-04,
                3.98706631e-04,
                4.02706747e-04,
                3.83362891e-04,
                3.87363094e-04,
                3.91363311e-04,
                3.95363527e-04,
                3.99363742e-04,
                4.03363957e-04,
                4.07364160e-04,
                4.11364352e-04,
                4.15364535e-04,
                4.19364700e-04,
                4.23364858e-04,
                4.27365011e-04,
                4.31365158e-04,
                4.35365300e-04,
                4.39365429e-04,
                4.43365554e-04,
                4.23153604e-04,
                4.27153858e-04,
                4.31154097e-04,
                4.35154323e-04,
                4.39154537e-04,
                4.43154742e-04,
                4.47154937e-04,
                4.51155125e-04,
                4.55155306e-04,
                4.59155469e-04,
                4.63155627e-04,
                4.67155780e-04,
                4.71155928e-04,
                4.75156072e-04,
                4.79156203e-04,
                4.27960332e-04,
                4.31960493e-04,
                4.35960632e-04,
                4.39960761e-04,
                4.43960880e-04,
                4.47960989e-04,
                4.51961097e-04,
                4.55961196e-04,
                4.59961294e-04,
                4.63961383e-04,
                4.67961472e-04,
                4.71961552e-04,
                4.75961632e-04,
                4.79961711e-04,
                4.83961783e-04,
                4.87961854e-04,
                4.91961925e-04,
                4.95961994e-04,
                4.99962063e-04,
                5.03962126e-04,
                3.79890631e-04,
                3.83890816e-04,
                3.87890985e-04,
                3.91891139e-04,
                3.95891281e-04,
                3.99891419e-04,
                4.03891545e-04,
                4.07891660e-04,
                4.11891773e-04,
                3.89112368e-04,
                3.93112561e-04,
                3.97112730e-04,
                4.01112878e-04,
                4.05113019e-04,
                4.09113164e-04,
                4.13113302e-04,
                4.17113434e-04,
                4.21113561e-04,
                4.25113683e-04,
                4.29113802e-04,
                4.33113908e-04,
                4.37114012e-04,
                4.18248957e-04,
                4.22249212e-04,
                4.26249424e-04,
                4.30249625e-04,
                4.34249816e-04,
                4.38250010e-04,
                4.42250185e-04,
                4.46250352e-04,
                4.50250514e-04,
                4.54250670e-04,
                4.58250820e-04,
                4.62250966e-04,
                4.66251098e-04,
                4.70251227e-04,
                4.74251352e-04,
                4.78251473e-04,
                4.82251584e-04,
                4.86251691e-04,
                4.90251797e-04,
                4.94251899e-04,
                4.98252000e-04,
                5.02252098e-04,
                5.06252186e-04,
                5.10252280e-04,
                5.14252365e-04,
                5.18252448e-04,
                5.22252530e-04,
                5.26252609e-04,
                5.30252687e-04,
                5.34252758e-04,
                5.38252833e-04,
                5.42252901e-04,
                5.46252967e-04,
                5.50253032e-04,
                5.54253096e-04,
                5.58253159e-04,
                5.62253220e-04,
            ]
        )
        # Define a geometry

        N = 3**2
        h = np.pi
        L = h * float(N)

        mesh = GooseFEM.Mesh.Quad4.FineLayer(N, N, h)

        coor = mesh.coor()
        conn = mesh.conn()
        dofs = mesh.dofs()

        plastic = mesh.elementsMiddleLayer()
        elastic = np.setdiff1d(np.arange(mesh.nelem()), plastic)

        left = mesh.nodesLeftOpenEdge()
        right = mesh.nodesRightOpenEdge()
        dofs[left] = dofs[right]

        top = mesh.nodesTopEdge()
        bottom = mesh.nodesBottomEdge()
        top.size
        iip = np.concatenate((dofs[bottom].ravel(), dofs[top].ravel()))

        c = 1.0
        G = 1.0
        K = 10.0 * G
        rho = G / c**2.0
        qL = 2.0 * np.pi / L
        qh = 2.0 * np.pi / h
        alpha = np.sqrt(2.0) * qL * c * rho
        dt = 1.0 / (c * qh) / 10.0

        k = 2.0

        generators = prrng.pcg32_array(np.arange(N), np.zeros(N))
        epsy = np.hstack((generators.random([1]), generators.weibull([1000], k)))
        epsy *= 1.0e-3
        epsy += 1.0e-5
        epsy = np.cumsum(epsy, 1)

        # Initialise system

        system = FrictionQPotFEM.Generic2d.System(coor, conn, dofs, iip, elastic, plastic)
        system.setMassMatrix(rho * np.ones(mesh.nelem()))
        system.setDampingMatrix(alpha * np.ones(mesh.nelem()))
        system.setElastic(K * np.ones(elastic.size), G * np.ones(elastic.size))
        system.setPlastic(K * np.ones(plastic.size), G * np.ones(plastic.size), epsy)
        system.setDt(dt)

        # Run

        dF = np.zeros((1001, 2, 2))
        dF[1:, 0, 1] = 0.004 / 1000.0

        compute_Eps = np.zeros(dF.shape[0])
        compute_Sig = np.zeros(dF.shape[0])
        compute_Sig_plastic = np.zeros(dF.shape[0])
        quad = system.quad()
        dV = quad.AsTensor(2, quad.dV())

        for inc in range(dF.shape[0]):

            u = system.u()

            for i in range(mesh.nnode()):
                for j in range(mesh.ndim()):
                    for k in range(mesh.ndim()):
                        u[i, j] += dF[inc, j, k] * (coor[i, k] - coor[0, k])

            system.setU(u)
            system.minimise()

            Epsbar = np.average(system.Eps(), weights=dV, axis=(0, 1))
            Sigbar = np.average(system.Sig(), weights=dV, axis=(0, 1))
            compute_Eps[inc] = GMat.Epsd(Epsbar)
            compute_Sig[inc] = GMat.Sigd(Sigbar)
            compute_Sig_plastic[inc] = GMat.Sigd(np.mean(system.plastic_Sig(), axis=(0, 1)))

        self.assertTrue(np.allclose(compute_Eps, check_Eps))
        self.assertTrue(np.allclose(compute_Sig, check_Sig))
        self.assertTrue(np.allclose(compute_Sig_plastic, check_Sig_plastic))


if __name__ == "__main__":

    unittest.main()
