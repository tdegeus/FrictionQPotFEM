import unittest

import FrictionQPotFEM
import GMatElastoPlasticQPot.Cartesian2d as GMat
import GooseFEM
import numpy as np
import prrng


class test_Generic2d(unittest.TestCase):
    """
    Tests
    """

    def test_historic(self):
        """
        A simple historic run.
        Thanks to prrng this test can be run on any platform, but also from any API (Python or C++).
        """

        check_Eps = np.array(
            [
                0,
                2e-06,
                4e-06,
                6e-06,
                8e-06,
                1e-05,
                1.2e-05,
                1.4e-05,
                1.6e-05,
                1.8e-05,
                2e-05,
                2.2e-05,
                2.4e-05,
                2.6e-05,
                2.8e-05,
                3e-05,
                3.2e-05,
                3.4e-05,
                3.6e-05,
                3.8e-05,
                4e-05,
                4.2e-05,
                4.4e-05,
                4.6e-05,
                4.8e-05,
                5e-05,
                5.2e-05,
                5.4e-05,
                5.6e-05,
                5.8e-05,
                6e-05,
                6.2e-05,
                6.4e-05,
                6.6e-05,
                6.8e-05,
                7e-05,
                7.2e-05,
                7.4e-05,
                7.6e-05,
                7.8e-05,
                8e-05,
                8.2e-05,
                8.4e-05,
                8.6e-05,
                8.8e-05,
                9e-05,
                9.2e-05,
                9.4e-05,
                9.6e-05,
                9.8e-05,
                0.0001,
                0.000102,
                0.000104,
                0.000106,
                0.000108,
                0.00011,
                0.000112,
                0.000114,
                0.000116,
                0.000118,
                0.00012,
                0.000122,
                0.000124,
                0.000126,
                0.000128,
                0.00013,
                0.000132,
                0.000134,
                0.000136,
                0.000138,
                0.00014,
                0.000142,
                0.000144,
                0.000146,
                0.000148,
                0.00015,
                0.000152,
                0.000154,
                0.000156,
                0.000158,
                0.00016,
                0.000162,
                0.000164,
                0.000166,
                0.000168,
                0.00017,
                0.000172,
                0.000174,
                0.000176,
                0.000178,
                0.00018,
                0.000182,
                0.000184,
                0.000186,
                0.000188,
                0.00019,
                0.000192,
                0.000194,
                0.000196,
                0.000198,
                0.0002,
                0.000202,
                0.000204,
                0.000206,
                0.000208,
                0.00021,
                0.000212,
                0.000214,
                0.000216,
                0.000218,
                0.00022,
                0.000222,
                0.000224,
                0.000226,
                0.000228,
                0.00023,
                0.000232,
                0.000234,
                0.000236,
                0.000238,
                0.00024,
                0.000242,
                0.000244,
                0.000246,
                0.000248,
                0.00025,
                0.000252,
                0.000254,
                0.000256,
                0.000258,
                0.00026,
                0.000262,
                0.000264,
                0.000266,
                0.000268,
                0.00027,
                0.000272,
                0.000274,
                0.000276,
                0.000278,
                0.00028,
                0.000282,
                0.000284,
                0.000286,
                0.000288,
                0.00029,
                0.000292,
                0.000294,
                0.000296,
                0.000298,
                0.0003,
                0.000302,
                0.000304,
                0.000306,
                0.000308,
                0.00031,
                0.000312,
                0.000314,
                0.000316,
                0.000318,
                0.00032,
                0.000322,
                0.000324,
                0.000326,
                0.000328,
                0.00033,
                0.000332,
                0.000334,
                0.000336,
                0.000338,
                0.00034,
                0.000342,
                0.000344,
                0.000346,
                0.000348,
                0.00035,
                0.000352,
                0.000354,
                0.000356,
                0.000358,
                0.00036,
                0.000362,
                0.000364,
                0.000366,
                0.000368,
                0.00037,
                0.000372,
                0.000374,
                0.000376,
                0.000378,
                0.00038,
                0.000382,
                0.000384,
                0.000386,
                0.000388,
                0.00039,
                0.000392,
                0.000394,
                0.000396,
                0.000398,
                0.0004,
                0.000402,
                0.000404,
                0.000406,
                0.000408,
                0.00041,
                0.000412,
                0.000414,
                0.000416,
                0.000418,
                0.00042,
                0.000422,
                0.000424,
                0.000426,
                0.000428,
                0.00043,
                0.000432,
                0.000434,
                0.000436,
                0.000438,
                0.00044,
                0.000442,
                0.000444,
                0.000446,
                0.000448,
                0.00045,
                0.000452,
                0.000454,
                0.000456,
                0.000458,
                0.00046,
                0.000462,
                0.000464,
                0.000466,
                0.000468,
                0.00047,
                0.000472,
                0.000474,
                0.000476,
                0.000478,
                0.00048,
                0.000482,
                0.000484,
                0.000486,
                0.000488,
                0.00049,
                0.000492,
                0.000494,
                0.000496,
                0.000498,
                0.0005,
                0.000502,
                0.000504,
                0.000506,
                0.000508,
                0.00051,
                0.000512,
                0.000514,
                0.000516,
                0.000518,
                0.00052,
                0.000522,
                0.000524,
                0.000526,
                0.000528,
                0.00053,
                0.000532,
                0.000534,
                0.000536,
                0.000538,
                0.00054,
                0.000542,
                0.000544,
                0.000546,
                0.000548,
                0.00055,
                0.000552,
                0.000554,
                0.000556,
                0.000558,
                0.00056,
                0.000562,
                0.000564,
                0.000566,
                0.000568,
                0.00057,
                0.000572,
                0.000574,
                0.000576,
                0.000578,
                0.00058,
                0.000582,
                0.000584,
                0.000586,
                0.000588,
                0.00059,
                0.000592,
                0.000594,
                0.000596,
                0.000598,
                0.0006,
                0.000602,
                0.000604,
                0.000606,
                0.000608,
                0.00061,
                0.000612,
                0.000614,
                0.000616,
                0.000618,
                0.00062,
                0.000622,
                0.000624,
                0.000626,
                0.000628,
                0.00063,
                0.000632,
                0.000634,
                0.000636,
                0.000638,
                0.00064,
                0.000642,
                0.000644,
                0.000646,
                0.000648,
                0.00065,
                0.000652,
                0.000654,
                0.000656,
                0.000658,
                0.00066,
                0.000662,
                0.000664,
                0.000666,
                0.000668,
                0.00067,
                0.000672,
                0.000674,
                0.000676,
                0.000678,
                0.00068,
                0.000682,
                0.000684,
                0.000686,
                0.000688,
                0.00069,
                0.000692,
                0.000694,
                0.000696,
                0.000698,
                0.0007,
                0.000702,
                0.000704,
                0.000706,
                0.000708,
                0.00071,
                0.000712,
                0.000714,
                0.000716,
                0.000718,
                0.00072,
                0.000722,
                0.000724,
                0.000726,
                0.000728,
                0.00073,
                0.000732,
                0.000734,
                0.000736,
                0.000738,
                0.00074,
                0.000742,
                0.000744,
                0.000746,
                0.000748,
                0.00075,
                0.000752,
                0.000754,
                0.000756,
                0.000758,
                0.00076,
                0.000762,
                0.000764,
                0.000766,
                0.000768,
                0.00077,
                0.000772,
                0.000774,
                0.000776,
                0.000778,
                0.00078,
                0.000782,
                0.000784,
                0.000786,
                0.000788,
                0.00079,
                0.000792,
                0.000794,
                0.000796,
                0.000798,
                0.0008,
                0.000802,
                0.000804,
                0.000806,
                0.000808,
                0.00081,
                0.000812,
                0.000814,
                0.000816,
                0.000818,
                0.00082,
                0.000822,
                0.000824,
                0.000826,
                0.000828,
                0.00083,
                0.000832,
                0.000834,
                0.000836,
                0.000838,
                0.00084,
                0.000842,
                0.000844,
                0.000846,
                0.000848,
                0.00085,
                0.000852,
                0.000854,
                0.000856,
                0.000858,
                0.00086,
                0.000862,
                0.000864,
                0.000866,
                0.000868,
                0.00087,
                0.000872,
                0.000874,
                0.000876,
                0.000878,
                0.00088,
                0.000882,
                0.000884,
                0.000886,
                0.000888,
                0.00089,
                0.000892,
                0.000894,
                0.000896,
                0.000898,
                0.0009,
                0.000902,
                0.000904,
                0.000906,
                0.000908,
                0.00091,
                0.000912,
                0.000914,
                0.000916,
                0.000918,
                0.00092,
                0.000922,
                0.000924,
                0.000926,
                0.000928,
                0.00093,
                0.000932,
                0.000934,
                0.000936,
                0.000938,
                0.00094,
                0.000942,
                0.000944,
                0.000946,
                0.000948,
                0.00095,
                0.000952,
                0.000954,
                0.000956,
                0.000958,
                0.00096,
                0.000962,
                0.000964,
                0.000966,
                0.000968,
                0.00097,
                0.000972,
                0.000974,
                0.000976,
                0.000978,
                0.00098,
                0.000982,
                0.000984,
                0.000986,
                0.000988,
                0.00099,
                0.000992,
                0.000994,
                0.000996,
                0.000998,
                0.001,
                0.001002,
                0.001004,
                0.001006,
                0.001008,
                0.00101,
                0.001012,
                0.001014,
                0.001016,
                0.001018,
                0.00102,
                0.001022,
                0.001024,
                0.001026,
                0.001028,
                0.00103,
                0.001032,
                0.001034,
                0.001036,
                0.001038,
                0.00104,
                0.001042,
                0.001044,
                0.001046,
                0.001048,
                0.00105,
                0.001052,
                0.001054,
                0.001056,
                0.001058,
                0.00106,
                0.001062,
                0.001064,
                0.001066,
                0.001068,
                0.00107,
                0.001072,
                0.001074,
                0.001076,
                0.001078,
                0.00108,
                0.001082,
                0.001084,
                0.001086,
                0.001088,
                0.00109,
                0.001092,
                0.001094,
                0.001096,
                0.001098,
                0.0011,
                0.001102,
                0.001104,
                0.001106,
                0.001108,
                0.00111,
                0.001112,
                0.001114,
                0.001116,
                0.001118,
                0.00112,
                0.001122,
                0.001124,
                0.001126,
                0.001128,
                0.00113,
                0.001132,
                0.001134,
                0.001136,
                0.001138,
                0.00114,
                0.001142,
                0.001144,
                0.001146,
                0.001148,
                0.00115,
                0.001152,
                0.001154,
                0.001156,
                0.001158,
                0.00116,
                0.001162,
                0.001164,
                0.001166,
                0.001168,
                0.00117,
                0.001172,
                0.001174,
                0.001176,
                0.001178,
                0.00118,
                0.001182,
                0.001184,
                0.001186,
                0.001188,
                0.00119,
                0.001192,
                0.001194,
                0.001196,
                0.001198,
                0.0012,
                0.001202,
                0.001204,
                0.001206,
                0.001208,
                0.00121,
                0.001212,
                0.001214,
                0.001216,
                0.001218,
                0.00122,
                0.001222,
                0.001224,
                0.001226,
                0.001228,
                0.00123,
                0.001232,
                0.001234,
                0.001236,
                0.001238,
                0.00124,
                0.001242,
                0.001244,
                0.001246,
                0.001248,
                0.00125,
                0.001252,
                0.001254,
                0.001256,
                0.001258,
                0.00126,
                0.001262,
                0.001264,
                0.001266,
                0.001268,
                0.00127,
                0.001272,
                0.001274,
                0.001276,
                0.001278,
                0.00128,
                0.001282,
                0.001284,
                0.001286,
                0.001288,
                0.00129,
                0.001292,
                0.001294,
                0.001296,
                0.001298,
                0.0013,
                0.001302,
                0.001304,
                0.001306,
                0.001308,
                0.00131,
                0.001312,
                0.001314,
                0.001316,
                0.001318,
                0.00132,
                0.001322,
                0.001324,
                0.001326,
                0.001328,
                0.00133,
                0.001332,
                0.001334,
                0.001336,
                0.001338,
                0.00134,
                0.001342,
                0.001344,
                0.001346,
                0.001348,
                0.00135,
                0.001352,
                0.001354,
                0.001356,
                0.001358,
                0.00136,
                0.001362,
                0.001364,
                0.001366,
                0.001368,
                0.00137,
                0.001372,
                0.001374,
                0.001376,
                0.001378,
                0.00138,
                0.001382,
                0.001384,
                0.001386,
                0.001388,
                0.00139,
                0.001392,
                0.001394,
                0.001396,
                0.001398,
                0.0014,
                0.001402,
                0.001404,
                0.001406,
                0.001408,
                0.00141,
                0.001412,
                0.001414,
                0.001416,
                0.001418,
                0.00142,
                0.001422,
                0.001424,
                0.001426,
                0.001428,
                0.00143,
                0.001432,
                0.001434,
                0.001436,
                0.001438,
                0.00144,
                0.001442,
                0.001444,
                0.001446,
                0.001448,
                0.00145,
                0.001452,
                0.001454,
                0.001456,
                0.001458,
                0.00146,
                0.001462,
                0.001464,
                0.001466,
                0.001468,
                0.00147,
                0.001472,
                0.001474,
                0.001476,
                0.001478,
                0.00148,
                0.001482,
                0.001484,
                0.001486,
                0.001488,
                0.00149,
                0.001492,
                0.001494,
                0.001496,
                0.001498,
                0.0015,
                0.001502,
                0.001504,
                0.001506,
                0.001508,
                0.00151,
                0.001512,
                0.001514,
                0.001516,
                0.001518,
                0.00152,
                0.001522,
                0.001524,
                0.001526,
                0.001528,
                0.00153,
                0.001532,
                0.001534,
                0.001536,
                0.001538,
                0.00154,
                0.001542,
                0.001544,
                0.001546,
                0.001548,
                0.00155,
                0.001552,
                0.001554,
                0.001556,
                0.001558,
                0.00156,
                0.001562,
                0.001564,
                0.001566,
                0.001568,
                0.00157,
                0.001572,
                0.001574,
                0.001576,
                0.001578,
                0.00158,
                0.001582,
                0.001584,
                0.001586,
                0.001588,
                0.00159,
                0.001592,
                0.001594,
                0.001596,
                0.001598,
                0.0016,
                0.001602,
                0.001604,
                0.001606,
                0.001608,
                0.00161,
                0.001612,
                0.001614,
                0.001616,
                0.001618,
                0.00162,
                0.001622,
                0.001624,
                0.001626,
                0.001628,
                0.00163,
                0.001632,
                0.001634,
                0.001636,
                0.001638,
                0.00164,
                0.001642,
                0.001644,
                0.001646,
                0.001648,
                0.00165,
                0.001652,
                0.001654,
                0.001656,
                0.001658,
                0.00166,
                0.001662,
                0.001664,
                0.001666,
                0.001668,
                0.00167,
                0.001672,
                0.001674,
                0.001676,
                0.001678,
                0.00168,
                0.001682,
                0.001684,
                0.001686,
                0.001688,
                0.00169,
                0.001692,
                0.001694,
                0.001696,
                0.001698,
                0.0017,
                0.001702,
                0.001704,
                0.001706,
                0.001708,
                0.00171,
                0.001712,
                0.001714,
                0.001716,
                0.001718,
                0.00172,
                0.001722,
                0.001724,
                0.001726,
                0.001728,
                0.00173,
                0.001732,
                0.001734,
                0.001736,
                0.001738,
                0.00174,
                0.001742,
                0.001744,
                0.001746,
                0.001748,
                0.00175,
                0.001752,
                0.001754,
                0.001756,
                0.001758,
                0.00176,
                0.001762,
                0.001764,
                0.001766,
                0.001768,
                0.00177,
                0.001772,
                0.001774,
                0.001776,
                0.001778,
                0.00178,
                0.001782,
                0.001784,
                0.001786,
                0.001788,
                0.00179,
                0.001792,
                0.001794,
                0.001796,
                0.001798,
                0.0018,
                0.001802,
                0.001804,
                0.001806,
                0.001808,
                0.00181,
                0.001812,
                0.001814,
                0.001816,
                0.001818,
                0.00182,
                0.001822,
                0.001824,
                0.001826,
                0.001828,
                0.00183,
                0.001832,
                0.001834,
                0.001836,
                0.001838,
                0.00184,
                0.001842,
                0.001844,
                0.001846,
                0.001848,
                0.00185,
                0.001852,
                0.001854,
                0.001856,
                0.001858,
                0.00186,
                0.001862,
                0.001864,
                0.001866,
                0.001868,
                0.00187,
                0.001872,
                0.001874,
                0.001876,
                0.001878,
                0.00188,
                0.001882,
                0.001884,
                0.001886,
                0.001888,
                0.00189,
                0.001892,
                0.001894,
                0.001896,
                0.001898,
                0.0019,
                0.001902,
                0.001904,
                0.001906,
                0.001908,
                0.00191,
                0.001912,
                0.001914,
                0.001916,
                0.001918,
                0.00192,
                0.001922,
                0.001924,
                0.001926,
                0.001928,
                0.00193,
                0.001932,
                0.001934,
                0.001936,
                0.001938,
                0.00194,
                0.001942,
                0.001944,
                0.001946,
                0.001948,
                0.00195,
                0.001952,
                0.001954,
                0.001956,
                0.001958,
                0.00196,
                0.001962,
                0.001964,
                0.001966,
                0.001968,
                0.00197,
                0.001972,
                0.001974,
                0.001976,
                0.001978,
                0.00198,
                0.001982,
                0.001984,
                0.001986,
                0.001988,
                0.00199,
                0.001992,
                0.001994,
                0.001996,
                0.001998,
                0.002,
            ]
        )

        check_Sig = np.array(
            [
                0.00000000e00,
                4.00000000e-06,
                8.00000000e-06,
                1.20000000e-05,
                1.60000000e-05,
                2.00000000e-05,
                2.40000000e-05,
                2.80000000e-05,
                3.20000000e-05,
                3.60000000e-05,
                4.00000000e-05,
                4.40000000e-05,
                4.80000000e-05,
                5.20000000e-05,
                5.60000000e-05,
                6.00000000e-05,
                6.40000000e-05,
                6.80000000e-05,
                7.20000000e-05,
                7.60000000e-05,
                8.00000000e-05,
                8.40000000e-05,
                8.80000000e-05,
                9.20000000e-05,
                9.60000000e-05,
                1.00000000e-04,
                1.04000000e-04,
                1.08000000e-04,
                1.12000000e-04,
                1.16000000e-04,
                1.20000000e-04,
                1.24000000e-04,
                1.28000000e-04,
                1.32000000e-04,
                1.36000000e-04,
                1.40000000e-04,
                9.93637130e-05,
                1.03363709e-04,
                1.07363706e-04,
                1.11363702e-04,
                1.15363699e-04,
                1.19363695e-04,
                1.23363692e-04,
                1.27363689e-04,
                1.31363685e-04,
                1.35363682e-04,
                1.39363679e-04,
                1.43363677e-04,
                1.47363674e-04,
                1.51363671e-04,
                1.55363668e-04,
                1.59363666e-04,
                1.63363663e-04,
                1.67363661e-04,
                1.71363659e-04,
                1.75363656e-04,
                1.79363654e-04,
                1.83363652e-04,
                1.87363650e-04,
                1.91363648e-04,
                1.95363646e-04,
                1.99363644e-04,
                2.03363642e-04,
                2.07363640e-04,
                2.11363638e-04,
                2.15363636e-04,
                2.19363635e-04,
                2.23363633e-04,
                2.27363631e-04,
                2.31363630e-04,
                2.35363628e-04,
                2.39363627e-04,
                2.43363625e-04,
                2.47363624e-04,
                2.51363622e-04,
                2.55363621e-04,
                2.59363620e-04,
                2.63363618e-04,
                2.67363617e-04,
                2.71363616e-04,
                2.75363615e-04,
                2.79363614e-04,
                2.83363612e-04,
                2.87363611e-04,
                2.91363610e-04,
                2.95363609e-04,
                2.99363608e-04,
                3.03363607e-04,
                3.07363606e-04,
                3.11363605e-04,
                3.15363604e-04,
                3.19363603e-04,
                3.23363602e-04,
                3.27363601e-04,
                3.31363600e-04,
                3.35363599e-04,
                3.39363598e-04,
                3.43363598e-04,
                3.47363597e-04,
                3.51363596e-04,
                3.55363595e-04,
                3.59363594e-04,
                3.63363594e-04,
                3.67363593e-04,
                3.71363592e-04,
                3.75363591e-04,
                3.79363591e-04,
                3.83363590e-04,
                3.87363589e-04,
                3.91363589e-04,
                3.95363588e-04,
                3.99363587e-04,
                4.03363587e-04,
                4.07363586e-04,
                4.11363586e-04,
                4.15363585e-04,
                4.19363584e-04,
                4.23363584e-04,
                4.27363583e-04,
                4.31363583e-04,
                4.35363582e-04,
                4.39363582e-04,
                4.43363581e-04,
                4.47363580e-04,
                4.51363580e-04,
                4.55363579e-04,
                4.59363579e-04,
                4.63363578e-04,
                4.67363578e-04,
                4.71363578e-04,
                4.75363577e-04,
                4.79363577e-04,
                4.83363576e-04,
                4.87363576e-04,
                4.91363575e-04,
                4.95363575e-04,
                4.99363574e-04,
                5.03363574e-04,
                5.07363574e-04,
                5.11363573e-04,
                5.15363573e-04,
                5.19363572e-04,
                5.23363572e-04,
                5.27363572e-04,
                5.31363571e-04,
                5.35363571e-04,
                5.39363571e-04,
                5.43363570e-04,
                5.47363570e-04,
                5.51363570e-04,
                5.55363569e-04,
                5.59363569e-04,
                5.63363569e-04,
                5.67363568e-04,
                5.71363568e-04,
                5.75363568e-04,
                5.79363567e-04,
                5.83363567e-04,
                5.87363567e-04,
                5.91363566e-04,
                5.95363566e-04,
                5.99363566e-04,
                6.03363566e-04,
                6.07363565e-04,
                6.11363565e-04,
                6.15363565e-04,
                6.19363564e-04,
                6.23363564e-04,
                6.27363564e-04,
                6.31363564e-04,
                6.35363563e-04,
                6.39363563e-04,
                6.43363563e-04,
                6.47363563e-04,
                6.51363562e-04,
                6.55363562e-04,
                6.59363562e-04,
                6.63363562e-04,
                6.67363561e-04,
                6.71363561e-04,
                6.75363561e-04,
                6.62016034e-04,
                6.66016034e-04,
                6.70016034e-04,
                6.74016034e-04,
                6.78016034e-04,
                6.82016034e-04,
                6.86016034e-04,
                6.90016034e-04,
                6.94016034e-04,
                6.98016034e-04,
                7.02016034e-04,
                7.06016034e-04,
                7.10016034e-04,
                7.14016034e-04,
                7.18016034e-04,
                7.22016034e-04,
                7.26016034e-04,
                7.30016034e-04,
                7.34016034e-04,
                7.38016033e-04,
                7.42016033e-04,
                7.46016033e-04,
                7.50016033e-04,
                7.54016033e-04,
                7.58016033e-04,
                7.62016033e-04,
                7.66016033e-04,
                7.70016033e-04,
                7.74016033e-04,
                7.78016033e-04,
                7.82016033e-04,
                7.86016033e-04,
                7.90016033e-04,
                7.94016033e-04,
                7.98016033e-04,
                8.02016033e-04,
                8.06016033e-04,
                8.10016033e-04,
                8.14016033e-04,
                8.18016033e-04,
                8.22016033e-04,
                8.26016033e-04,
                8.30016033e-04,
                8.34016033e-04,
                8.38016033e-04,
                8.42016033e-04,
                8.19895098e-04,
                8.23894575e-04,
                8.27894043e-04,
                8.31893510e-04,
                8.35892980e-04,
                8.39892456e-04,
                8.43891936e-04,
                8.47891419e-04,
                8.51890910e-04,
                8.55890404e-04,
                8.59889902e-04,
                8.63889406e-04,
                8.67888914e-04,
                8.71888427e-04,
                8.75887945e-04,
                8.79887466e-04,
                8.83886992e-04,
                8.87886525e-04,
                8.91886059e-04,
                8.95885599e-04,
                8.99885142e-04,
                9.03884690e-04,
                9.07884243e-04,
                9.11883799e-04,
                9.15883359e-04,
                9.19882923e-04,
                9.23882491e-04,
                9.27882064e-04,
                9.31881639e-04,
                9.35881220e-04,
                9.39880803e-04,
                9.43880391e-04,
                9.47879982e-04,
                9.51879576e-04,
                9.55879174e-04,
                9.59878775e-04,
                9.63878382e-04,
                9.67877990e-04,
                9.71877602e-04,
                9.75877217e-04,
                9.79876836e-04,
                9.83876459e-04,
                9.87876084e-04,
                9.91875713e-04,
                9.95875345e-04,
                9.99874981e-04,
                1.00387462e-03,
                1.00787426e-03,
                1.01187390e-03,
                1.01587355e-03,
                1.01987320e-03,
                1.02387286e-03,
                1.02787251e-03,
                1.03187217e-03,
                1.03587183e-03,
                1.03987150e-03,
                1.04387117e-03,
                1.04787083e-03,
                1.05187051e-03,
                1.05587018e-03,
                1.05986986e-03,
                1.06386954e-03,
                1.06786923e-03,
                1.07186891e-03,
                1.07586860e-03,
                1.07986829e-03,
                1.08386799e-03,
                1.08786768e-03,
                1.09186738e-03,
                1.09586708e-03,
                1.09986679e-03,
                1.10386649e-03,
                1.10786620e-03,
                1.11186591e-03,
                1.11586562e-03,
                1.11986534e-03,
                1.12386506e-03,
                1.12786478e-03,
                1.13186450e-03,
                1.13586422e-03,
                1.13986395e-03,
                1.14386368e-03,
                1.14786341e-03,
                1.15186314e-03,
                1.15586287e-03,
                1.15986261e-03,
                1.16386235e-03,
                1.16786209e-03,
                1.17186183e-03,
                1.17586158e-03,
                1.17986132e-03,
                1.18386107e-03,
                1.18786082e-03,
                1.19186057e-03,
                1.19586033e-03,
                1.19986009e-03,
                1.20385984e-03,
                1.20785960e-03,
                1.21185936e-03,
                1.21585913e-03,
                1.21985889e-03,
                1.22385866e-03,
                1.22785843e-03,
                1.23185820e-03,
                1.23585797e-03,
                1.23985774e-03,
                1.24385752e-03,
                1.24785729e-03,
                1.25185707e-03,
                1.25585685e-03,
                1.25985663e-03,
                1.26385642e-03,
                1.26785620e-03,
                1.27185599e-03,
                1.27585578e-03,
                1.27985556e-03,
                1.28385535e-03,
                1.28785515e-03,
                1.29185494e-03,
                1.29585474e-03,
                1.29985453e-03,
                1.30385433e-03,
                1.30785413e-03,
                1.31185393e-03,
                1.31585373e-03,
                1.31985353e-03,
                1.32385334e-03,
                1.32785315e-03,
                1.33185295e-03,
                1.33585276e-03,
                1.31485966e-03,
                1.31885947e-03,
                1.32285928e-03,
                1.32685908e-03,
                1.33085889e-03,
                1.33485870e-03,
                1.33885852e-03,
                1.34285833e-03,
                1.34685814e-03,
                1.35085796e-03,
                1.35485777e-03,
                1.35885759e-03,
                1.36285741e-03,
                1.36685723e-03,
                1.37085705e-03,
                1.37485687e-03,
                1.37885669e-03,
                1.38285652e-03,
                1.38685634e-03,
                1.39085617e-03,
                1.39485600e-03,
                1.39885583e-03,
                1.40285566e-03,
                1.40685549e-03,
                1.41085532e-03,
                1.41485515e-03,
                1.41885499e-03,
                1.42285483e-03,
                1.42685466e-03,
                1.43085450e-03,
                1.43485434e-03,
                1.43885418e-03,
                1.44285402e-03,
                1.44685386e-03,
                1.45085370e-03,
                1.45485355e-03,
                1.45885339e-03,
                1.46285324e-03,
                1.46685309e-03,
                1.47085294e-03,
                1.47485278e-03,
                1.47885263e-03,
                1.48285249e-03,
                1.48685234e-03,
                1.49085219e-03,
                1.46545000e-03,
                1.46944984e-03,
                1.47344969e-03,
                1.47744954e-03,
                1.48144938e-03,
                1.48544923e-03,
                1.48944908e-03,
                1.49344893e-03,
                1.49744877e-03,
                1.50144863e-03,
                1.50544848e-03,
                1.50944833e-03,
                1.51344818e-03,
                1.51744804e-03,
                1.52144789e-03,
                1.52544775e-03,
                1.52944760e-03,
                1.53344746e-03,
                1.53744732e-03,
                1.54144718e-03,
                1.54544704e-03,
                1.54944690e-03,
                1.55344677e-03,
                1.55744663e-03,
                1.56144649e-03,
                1.56544636e-03,
                1.56944622e-03,
                1.57344609e-03,
                1.57744596e-03,
                1.58144583e-03,
                1.58544570e-03,
                1.58944557e-03,
                1.59344544e-03,
                1.59744531e-03,
                1.60144518e-03,
                1.60544506e-03,
                1.60944493e-03,
                1.61344481e-03,
                1.61744468e-03,
                1.62144456e-03,
                1.62544444e-03,
                1.62944431e-03,
                1.63344419e-03,
                1.63744407e-03,
                1.64144395e-03,
                1.64544383e-03,
                1.64944372e-03,
                1.65344360e-03,
                1.65744348e-03,
                1.66144337e-03,
                1.66544325e-03,
                1.66944314e-03,
                1.67344302e-03,
                1.67744291e-03,
                1.68144280e-03,
                1.68544269e-03,
                1.68944257e-03,
                1.69344246e-03,
                1.69744235e-03,
                1.70144225e-03,
                1.70544214e-03,
                1.70944203e-03,
                1.71344192e-03,
                1.71744182e-03,
                1.72144171e-03,
                1.72544161e-03,
                1.72944150e-03,
                1.73344140e-03,
                1.73744129e-03,
                1.74144119e-03,
                1.74544109e-03,
                1.74944099e-03,
                1.75344089e-03,
                1.75744079e-03,
                1.76144069e-03,
                1.76544059e-03,
                1.76944049e-03,
                1.77344039e-03,
                1.77744029e-03,
                1.78144020e-03,
                1.78544010e-03,
                1.78944001e-03,
                1.79343991e-03,
                1.79743982e-03,
                1.80143972e-03,
                1.80543963e-03,
                1.80943954e-03,
                1.81343944e-03,
                1.81743935e-03,
                1.82143926e-03,
                1.82543917e-03,
                1.82943908e-03,
                1.83343899e-03,
                1.83743890e-03,
                1.84143881e-03,
                1.84543872e-03,
                1.84943863e-03,
                1.85343855e-03,
                1.75455348e-03,
                1.75855340e-03,
                1.76255332e-03,
                1.76655324e-03,
                1.77055316e-03,
                1.77455309e-03,
                1.77855301e-03,
                1.78255293e-03,
                1.78655286e-03,
                1.79055278e-03,
                1.79455270e-03,
                1.79855263e-03,
                1.80255255e-03,
                1.80655248e-03,
                1.81055240e-03,
                1.81455233e-03,
                1.81855226e-03,
                1.82255218e-03,
                1.82655211e-03,
                1.83055204e-03,
                1.83455197e-03,
                1.83855190e-03,
                1.84255183e-03,
                1.84655176e-03,
                1.85055169e-03,
                1.85455162e-03,
                1.85855155e-03,
                1.86255148e-03,
                1.86655141e-03,
                1.87055134e-03,
                1.87455127e-03,
                1.87855120e-03,
                1.88255114e-03,
                1.88655107e-03,
                1.89055100e-03,
                1.88244546e-03,
                1.88644543e-03,
                1.89044539e-03,
                1.89444535e-03,
                1.89844532e-03,
                1.90244529e-03,
                1.90644525e-03,
                1.91044522e-03,
                1.91444518e-03,
                1.91844515e-03,
                1.92244511e-03,
                1.92644508e-03,
                1.93044505e-03,
                1.93444501e-03,
                1.93844498e-03,
                1.94244495e-03,
                1.94644492e-03,
                1.95044488e-03,
                1.95444485e-03,
                1.95844482e-03,
                1.96244479e-03,
                1.96644475e-03,
                1.97044472e-03,
                1.97444469e-03,
                1.97844466e-03,
                1.98244463e-03,
                1.98644460e-03,
                1.99044457e-03,
                1.99444454e-03,
                1.99844450e-03,
                2.00244447e-03,
                2.00644444e-03,
                2.01044441e-03,
                2.01444438e-03,
                2.01844435e-03,
                2.02244432e-03,
                2.02644429e-03,
                2.03044427e-03,
                2.03444424e-03,
                2.03844421e-03,
                2.04244418e-03,
                2.04644415e-03,
                2.05044412e-03,
                2.05444409e-03,
                2.05844406e-03,
                2.06244403e-03,
                2.06644401e-03,
                2.06140543e-03,
                2.06540540e-03,
                2.06940537e-03,
                2.07340534e-03,
                2.07740532e-03,
                2.08140529e-03,
                2.08540526e-03,
                2.08940523e-03,
                2.09340520e-03,
                2.09740517e-03,
                2.10140514e-03,
                2.10540511e-03,
                2.10940508e-03,
                2.11340505e-03,
                2.11740503e-03,
                2.12140500e-03,
                2.12540497e-03,
                2.12940494e-03,
                2.13340491e-03,
                2.13740489e-03,
                2.14140486e-03,
                2.14540483e-03,
                2.14940480e-03,
                2.15340477e-03,
                2.15740475e-03,
                2.16140472e-03,
                2.16540469e-03,
                2.16940467e-03,
                2.17340464e-03,
                2.17740461e-03,
                2.18140459e-03,
                2.18540456e-03,
                2.18940453e-03,
                2.19340451e-03,
                2.19740448e-03,
                2.20140446e-03,
                2.20540443e-03,
                2.20940440e-03,
                2.21340438e-03,
                2.21740435e-03,
                2.22140433e-03,
                2.22540430e-03,
                2.22940428e-03,
                2.23340425e-03,
                2.22144960e-03,
                2.22544957e-03,
                2.22944954e-03,
                2.23344952e-03,
                2.23744949e-03,
                2.24144947e-03,
                2.24544944e-03,
                2.24944942e-03,
                2.25344939e-03,
                2.25744937e-03,
                2.26144934e-03,
                2.26544932e-03,
                2.26944929e-03,
                2.25884722e-03,
                2.26284717e-03,
                2.26684712e-03,
                2.27084707e-03,
                2.27484702e-03,
                2.27884697e-03,
                2.28284691e-03,
                2.28684686e-03,
                2.29084681e-03,
                2.29484676e-03,
                2.29884671e-03,
                2.30284667e-03,
                2.30684662e-03,
                2.31084657e-03,
                2.31484652e-03,
                2.31884647e-03,
                2.32284642e-03,
                2.32684637e-03,
                2.33084633e-03,
                2.33484628e-03,
                2.33884623e-03,
                2.34284618e-03,
                2.34684614e-03,
                2.35084609e-03,
                2.35484604e-03,
                2.35884599e-03,
                2.36284595e-03,
                2.36684590e-03,
                2.37084586e-03,
                2.37484581e-03,
                2.37884576e-03,
                2.38284572e-03,
                2.38684567e-03,
                2.39084563e-03,
                2.39484558e-03,
                2.39884554e-03,
                2.40284549e-03,
                2.40684545e-03,
                2.41084541e-03,
                2.41484536e-03,
                2.41884532e-03,
                2.42284527e-03,
                2.42684523e-03,
                2.43084519e-03,
                2.43484515e-03,
                2.43884510e-03,
                2.44284506e-03,
                2.44684502e-03,
                2.45084497e-03,
                2.45484493e-03,
                2.45884489e-03,
                2.46284485e-03,
                2.46684481e-03,
                2.47084477e-03,
                2.47484472e-03,
                2.47884468e-03,
                2.48284464e-03,
                2.48684460e-03,
                2.46421169e-03,
                2.46821166e-03,
                2.47221164e-03,
                2.47621161e-03,
                2.48021158e-03,
                2.48421155e-03,
                2.48821153e-03,
                2.49221150e-03,
                2.49621148e-03,
                2.50021145e-03,
                2.50421142e-03,
                2.50821140e-03,
                2.51221137e-03,
                2.51621135e-03,
                2.52021132e-03,
                2.52421129e-03,
                2.52821127e-03,
                2.53221124e-03,
                2.53621122e-03,
                2.54021119e-03,
                2.54421117e-03,
                2.54821114e-03,
                2.55221112e-03,
                2.55621109e-03,
                2.56021107e-03,
                2.56421104e-03,
                2.56821102e-03,
                2.57221099e-03,
                2.57621097e-03,
                2.58021095e-03,
                2.58421092e-03,
                2.58821090e-03,
                2.59221087e-03,
                2.59621085e-03,
                2.60021083e-03,
                2.60421080e-03,
                2.60821078e-03,
                2.61221075e-03,
                2.61621073e-03,
                2.62021071e-03,
                2.62421069e-03,
                2.62821066e-03,
                2.63221064e-03,
                2.63621062e-03,
                2.64021059e-03,
                2.64421057e-03,
                2.64821055e-03,
                2.65221053e-03,
                2.65621050e-03,
                2.66021048e-03,
                2.66421046e-03,
                2.66821044e-03,
                2.67221041e-03,
                2.67621039e-03,
                2.68021037e-03,
                2.65958864e-03,
                2.66358859e-03,
                2.66758854e-03,
                2.67158850e-03,
                2.67558845e-03,
                2.67958840e-03,
                2.68358835e-03,
                2.68758830e-03,
                2.69158826e-03,
                2.69558821e-03,
                2.69958816e-03,
                2.70358812e-03,
                2.70758807e-03,
                2.71158802e-03,
                2.71558798e-03,
                2.71958793e-03,
                2.72358788e-03,
                2.72758784e-03,
                2.73158779e-03,
                2.73558775e-03,
                2.73958770e-03,
                2.74358765e-03,
                2.74758761e-03,
                2.75158756e-03,
                2.75558752e-03,
                2.75958747e-03,
                2.76358743e-03,
                2.76758739e-03,
                2.77158734e-03,
                2.77558730e-03,
                2.77958725e-03,
                2.78358721e-03,
                2.78758717e-03,
                2.79158712e-03,
                2.79558708e-03,
                2.76699883e-03,
                2.77099878e-03,
                2.77499873e-03,
                2.77899868e-03,
                2.78299863e-03,
                2.78699858e-03,
                2.79099854e-03,
                2.79499849e-03,
                2.79899844e-03,
                2.80299839e-03,
                2.80699835e-03,
                2.81099830e-03,
                2.81499825e-03,
                2.81899820e-03,
                2.82299816e-03,
                2.82699811e-03,
                2.83099806e-03,
                2.83499802e-03,
                2.83899797e-03,
                2.84299793e-03,
                2.84699788e-03,
                2.85099783e-03,
                2.85499779e-03,
                2.85899774e-03,
                2.86299770e-03,
                2.86699765e-03,
                2.87099761e-03,
                2.87499756e-03,
                2.87899752e-03,
                2.88299748e-03,
                2.88699743e-03,
                2.89099739e-03,
                2.89499734e-03,
                2.89899730e-03,
                2.90299726e-03,
                2.90699721e-03,
                2.91099717e-03,
                2.91499713e-03,
                2.91899708e-03,
                2.92299704e-03,
                2.92699700e-03,
                2.93099695e-03,
                2.93499691e-03,
                2.93899687e-03,
                2.94299683e-03,
                2.94699678e-03,
                2.95099674e-03,
                2.95499670e-03,
                2.95899666e-03,
                2.96299662e-03,
                2.96699658e-03,
                2.97099654e-03,
                2.97499649e-03,
                2.97899645e-03,
                2.98299641e-03,
                2.98699637e-03,
                2.99099633e-03,
                2.99499629e-03,
                2.99899625e-03,
                3.00299621e-03,
                3.00699617e-03,
                3.01099613e-03,
                3.01499609e-03,
                3.01899605e-03,
                3.02299601e-03,
                3.02699597e-03,
                3.03099593e-03,
                3.03499589e-03,
                3.03899585e-03,
                3.04299581e-03,
                3.04699578e-03,
                3.05099574e-03,
                3.05499570e-03,
                3.05899566e-03,
                3.06299562e-03,
                3.06699558e-03,
                3.07099555e-03,
                3.07499551e-03,
                3.07899547e-03,
                3.03794547e-03,
                3.04194538e-03,
                3.04594530e-03,
                3.04994521e-03,
                3.05394513e-03,
                3.05794504e-03,
                3.06194495e-03,
                3.06594487e-03,
                3.06994478e-03,
                3.07394470e-03,
                3.07794461e-03,
                3.08194453e-03,
                3.08594444e-03,
                3.08994436e-03,
                3.09394428e-03,
                3.09794419e-03,
                3.10194411e-03,
                3.10594403e-03,
                3.10994394e-03,
                3.11394386e-03,
                3.11794378e-03,
                3.12194370e-03,
                3.12594362e-03,
                3.12994353e-03,
                3.13394345e-03,
                3.13794337e-03,
                3.14194329e-03,
                3.14594321e-03,
                3.14994313e-03,
                3.15394305e-03,
                3.15794297e-03,
                3.16194289e-03,
                3.16594281e-03,
                3.16994273e-03,
                3.17394266e-03,
                3.17794258e-03,
                3.18194250e-03,
                3.18594242e-03,
                3.18994234e-03,
                3.19394227e-03,
                3.19794219e-03,
                3.20194211e-03,
                3.20594204e-03,
                3.20994196e-03,
                3.21394188e-03,
                3.21794181e-03,
                3.22194173e-03,
                3.22594165e-03,
                3.22994158e-03,
                3.23394150e-03,
                3.23794143e-03,
                3.24194136e-03,
                3.24594128e-03,
                3.24994121e-03,
                3.25394113e-03,
                3.25794106e-03,
                3.26194099e-03,
                3.26594091e-03,
                3.26994084e-03,
                3.27394077e-03,
                3.27794069e-03,
                3.28194062e-03,
                3.28594055e-03,
                3.28994048e-03,
                3.29394041e-03,
                3.29794033e-03,
                3.30194026e-03,
                3.30594019e-03,
                3.30994012e-03,
                3.31394005e-03,
                3.31793998e-03,
                3.32193991e-03,
                3.32593984e-03,
                3.32993977e-03,
                3.33393970e-03,
                3.33793963e-03,
                3.34193956e-03,
                3.34593949e-03,
                3.34993942e-03,
                3.35393936e-03,
                3.35793929e-03,
                3.36193922e-03,
                3.36593915e-03,
                3.36993908e-03,
                3.37393902e-03,
                3.37793895e-03,
                3.37068789e-03,
                3.37468782e-03,
                3.37868775e-03,
                3.38268768e-03,
                3.37542743e-03,
                3.37942737e-03,
                3.38342731e-03,
                3.38742725e-03,
                3.39142719e-03,
                3.39542713e-03,
                3.39942707e-03,
                3.40342701e-03,
                3.40742695e-03,
                3.41142690e-03,
                3.41542684e-03,
                3.41942678e-03,
                3.42342672e-03,
                3.42742666e-03,
                3.43142660e-03,
                3.43542655e-03,
                3.43942649e-03,
                3.44342643e-03,
                3.44742637e-03,
                3.45142631e-03,
                3.45542626e-03,
                3.45942620e-03,
                3.44645572e-03,
                3.45045565e-03,
                3.45445559e-03,
                3.45845553e-03,
                3.46245547e-03,
                3.46645541e-03,
                3.47045535e-03,
                3.47445529e-03,
                3.47845523e-03,
                3.48245518e-03,
                3.48645512e-03,
                3.49045506e-03,
                3.49445500e-03,
                3.49845494e-03,
                3.50245488e-03,
                3.50645482e-03,
                3.51045477e-03,
                3.51445471e-03,
                3.51845465e-03,
                3.52245459e-03,
                3.52645453e-03,
                3.53045448e-03,
                3.53445442e-03,
            ]
        )

        check_Sig_plastic = np.array(
            [
                0.00000000e00,
                4.00000000e-06,
                8.00000000e-06,
                1.20000000e-05,
                1.60000000e-05,
                2.00000000e-05,
                2.40000000e-05,
                2.80000000e-05,
                3.20000000e-05,
                3.60000000e-05,
                4.00000000e-05,
                4.40000000e-05,
                4.80000000e-05,
                5.20000000e-05,
                5.60000000e-05,
                6.00000000e-05,
                6.40000000e-05,
                6.80000000e-05,
                7.20000000e-05,
                7.60000000e-05,
                8.00000000e-05,
                8.40000000e-05,
                8.80000000e-05,
                9.20000000e-05,
                9.60000000e-05,
                1.00000000e-04,
                1.04000000e-04,
                1.08000000e-04,
                1.12000000e-04,
                1.16000000e-04,
                1.20000000e-04,
                1.24000000e-04,
                1.28000000e-04,
                1.32000000e-04,
                1.36000000e-04,
                1.40000000e-04,
                2.25263580e-04,
                2.21263729e-04,
                2.17263807e-04,
                2.13263861e-04,
                2.09263905e-04,
                2.05263944e-04,
                2.01263978e-04,
                1.97264010e-04,
                1.93264040e-04,
                1.89264068e-04,
                1.85264094e-04,
                1.81264120e-04,
                1.77264145e-04,
                1.73264169e-04,
                1.69264192e-04,
                1.65264214e-04,
                1.61264236e-04,
                1.57264257e-04,
                1.53264277e-04,
                1.49264297e-04,
                1.45264316e-04,
                1.41264335e-04,
                1.37264353e-04,
                1.33264371e-04,
                1.29264388e-04,
                1.25264404e-04,
                1.21264420e-04,
                1.17264436e-04,
                1.13264451e-04,
                1.09264466e-04,
                1.05264480e-04,
                1.01264494e-04,
                9.72645080e-05,
                9.32645213e-05,
                8.92645342e-05,
                8.52645468e-05,
                8.12645591e-05,
                7.72645710e-05,
                7.32645827e-05,
                6.92645941e-05,
                6.52646052e-05,
                6.12646160e-05,
                5.72646266e-05,
                5.32646369e-05,
                4.92646469e-05,
                4.52646567e-05,
                4.12646663e-05,
                3.72646757e-05,
                3.32646849e-05,
                2.92646938e-05,
                2.52647026e-05,
                2.12647111e-05,
                1.72647195e-05,
                1.32647277e-05,
                9.26473571e-06,
                5.26474355e-06,
                1.26475122e-06,
                2.73524127e-06,
                6.73523392e-06,
                1.07352267e-05,
                1.47352197e-05,
                1.87352128e-05,
                2.27352060e-05,
                2.67351994e-05,
                3.07351929e-05,
                3.47351865e-05,
                3.87351802e-05,
                4.27351741e-05,
                4.67351681e-05,
                5.07351622e-05,
                5.47351564e-05,
                5.87351508e-05,
                6.27351452e-05,
                6.67351397e-05,
                7.07351344e-05,
                7.47351291e-05,
                7.87351239e-05,
                8.27351189e-05,
                8.67351139e-05,
                9.07351090e-05,
                9.47351042e-05,
                9.87350995e-05,
                1.02735095e-04,
                1.06735090e-04,
                1.10735086e-04,
                1.14735081e-04,
                1.18735077e-04,
                1.22735073e-04,
                1.26735069e-04,
                1.30735065e-04,
                1.34735060e-04,
                1.38735056e-04,
                1.42735053e-04,
                1.46735049e-04,
                1.50735045e-04,
                1.54735041e-04,
                1.58735038e-04,
                1.62735034e-04,
                1.66735030e-04,
                1.70735027e-04,
                1.74735023e-04,
                1.78735020e-04,
                1.82735017e-04,
                1.86735013e-04,
                1.90735010e-04,
                1.94735007e-04,
                1.98735004e-04,
                2.02735001e-04,
                2.06734998e-04,
                2.10734995e-04,
                2.14734992e-04,
                2.18734989e-04,
                2.22734986e-04,
                2.26734983e-04,
                2.30734981e-04,
                2.34734978e-04,
                2.38734975e-04,
                2.42734972e-04,
                2.46734970e-04,
                2.50734967e-04,
                2.54734965e-04,
                2.58734962e-04,
                2.62734960e-04,
                2.66734957e-04,
                2.70734955e-04,
                2.74734952e-04,
                2.78734950e-04,
                2.82734948e-04,
                2.86734946e-04,
                2.90734943e-04,
                2.94734941e-04,
                2.98734939e-04,
                3.02734937e-04,
                3.06734935e-04,
                3.10734933e-04,
                3.14734930e-04,
                3.18734928e-04,
                3.22734926e-04,
                3.26734924e-04,
                3.30734922e-04,
                3.34734920e-04,
                3.38734919e-04,
                3.42734917e-04,
                3.46734915e-04,
                3.50734913e-04,
                2.11223429e-04,
                2.15223419e-04,
                2.19223436e-04,
                2.23223452e-04,
                2.27223466e-04,
                2.31223478e-04,
                2.35223488e-04,
                2.39223497e-04,
                2.43223505e-04,
                2.47223512e-04,
                2.51223519e-04,
                2.55223524e-04,
                2.59223529e-04,
                2.63223533e-04,
                2.67223536e-04,
                2.71223539e-04,
                2.75223542e-04,
                2.79223544e-04,
                2.83223545e-04,
                2.87223547e-04,
                2.91223548e-04,
                2.95223549e-04,
                2.99223549e-04,
                3.03223550e-04,
                3.07223550e-04,
                3.11223551e-04,
                3.15223551e-04,
                3.19223551e-04,
                3.23223551e-04,
                3.27223551e-04,
                3.31223551e-04,
                3.35223550e-04,
                3.39223550e-04,
                3.43223550e-04,
                3.47223550e-04,
                3.51223549e-04,
                3.55223549e-04,
                3.59223549e-04,
                3.63223549e-04,
                3.67223548e-04,
                3.71223548e-04,
                3.75223548e-04,
                3.79223547e-04,
                3.83223547e-04,
                3.87223547e-04,
                3.91223546e-04,
                1.79128428e-04,
                1.83125529e-04,
                1.87122143e-04,
                1.91118037e-04,
                1.95113851e-04,
                1.99109612e-04,
                2.03105385e-04,
                2.07101183e-04,
                2.11096994e-04,
                2.15092843e-04,
                2.19088726e-04,
                2.23084631e-04,
                2.27080579e-04,
                2.31076560e-04,
                2.35072575e-04,
                2.39068626e-04,
                2.43064712e-04,
                2.47060830e-04,
                2.51056993e-04,
                2.55053179e-04,
                2.59049411e-04,
                2.63045666e-04,
                2.67041963e-04,
                2.71038291e-04,
                2.75034653e-04,
                2.79031048e-04,
                2.83027476e-04,
                2.87023932e-04,
                2.91020429e-04,
                2.95016947e-04,
                2.99013503e-04,
                3.03010088e-04,
                3.07006704e-04,
                3.11003350e-04,
                3.15000025e-04,
                3.18996730e-04,
                3.22993459e-04,
                3.26990228e-04,
                3.30987013e-04,
                3.34983838e-04,
                3.38980679e-04,
                3.42977554e-04,
                3.46974455e-04,
                3.50971383e-04,
                3.54968337e-04,
                3.58965313e-04,
                3.62962325e-04,
                3.66959352e-04,
                3.70956414e-04,
                3.74953491e-04,
                3.78950598e-04,
                3.82947730e-04,
                3.86944885e-04,
                3.90942064e-04,
                3.94939267e-04,
                3.98936493e-04,
                4.02933738e-04,
                4.06931015e-04,
                4.10928305e-04,
                4.14925627e-04,
                4.18922961e-04,
                4.22920322e-04,
                4.26917705e-04,
                4.30915109e-04,
                4.34912534e-04,
                4.38909980e-04,
                4.42907442e-04,
                4.46904934e-04,
                4.50902436e-04,
                4.54899969e-04,
                4.58897511e-04,
                4.62895078e-04,
                4.66892669e-04,
                4.70890264e-04,
                4.74887899e-04,
                4.78885532e-04,
                4.82883198e-04,
                4.86880879e-04,
                4.90878572e-04,
                4.94876293e-04,
                4.98874022e-04,
                5.02871779e-04,
                5.06869543e-04,
                5.10867329e-04,
                5.14865133e-04,
                5.18862953e-04,
                5.22860790e-04,
                5.26858644e-04,
                5.30856514e-04,
                5.34854401e-04,
                5.38852298e-04,
                5.42850221e-04,
                5.46848151e-04,
                5.50846105e-04,
                5.54844066e-04,
                5.58842045e-04,
                5.62840046e-04,
                5.66838047e-04,
                5.70836082e-04,
                5.74834113e-04,
                5.78832171e-04,
                5.82830240e-04,
                5.86828324e-04,
                5.90826416e-04,
                5.94824531e-04,
                5.98822652e-04,
                6.02820795e-04,
                6.06818943e-04,
                6.10817114e-04,
                6.14815289e-04,
                6.18813480e-04,
                6.22811685e-04,
                6.26809903e-04,
                6.30808134e-04,
                6.34806378e-04,
                6.38804635e-04,
                6.42802903e-04,
                6.46801185e-04,
                6.50799478e-04,
                6.54797784e-04,
                6.58796101e-04,
                6.62794431e-04,
                6.66792772e-04,
                6.70791125e-04,
                6.74789489e-04,
                6.78787865e-04,
                6.82786253e-04,
                6.86784651e-04,
                6.90783061e-04,
                6.94781481e-04,
                4.92021337e-04,
                4.96019681e-04,
                5.00017949e-04,
                5.04016240e-04,
                5.08014565e-04,
                5.12012922e-04,
                5.16011307e-04,
                5.20009713e-04,
                5.24008139e-04,
                5.28006581e-04,
                5.32005037e-04,
                5.36003507e-04,
                5.40001991e-04,
                5.44000486e-04,
                5.47998993e-04,
                5.51997511e-04,
                5.55996041e-04,
                5.59994582e-04,
                5.63993133e-04,
                5.67991695e-04,
                5.71990267e-04,
                5.75988850e-04,
                5.79987442e-04,
                5.83986045e-04,
                5.87984657e-04,
                5.91983279e-04,
                5.95981910e-04,
                5.99980551e-04,
                6.03979201e-04,
                6.07977860e-04,
                6.11976528e-04,
                6.15975205e-04,
                6.19973892e-04,
                6.23972586e-04,
                6.27971290e-04,
                6.31970002e-04,
                6.35968723e-04,
                6.39967452e-04,
                6.43966189e-04,
                6.47964935e-04,
                6.51963689e-04,
                6.55962451e-04,
                6.59961221e-04,
                6.63959999e-04,
                6.67958785e-04,
                4.28721022e-04,
                4.32720090e-04,
                4.36719035e-04,
                4.40717923e-04,
                4.44716777e-04,
                4.48715609e-04,
                4.52714427e-04,
                4.56713236e-04,
                4.60712042e-04,
                4.64710846e-04,
                4.68709652e-04,
                4.72708460e-04,
                4.76707272e-04,
                4.80706089e-04,
                4.84704910e-04,
                4.88703737e-04,
                4.92702570e-04,
                4.96701409e-04,
                5.00700254e-04,
                5.04699106e-04,
                5.08697964e-04,
                5.12696828e-04,
                5.16695699e-04,
                5.20694577e-04,
                5.24693462e-04,
                5.28692353e-04,
                5.32691250e-04,
                5.36690155e-04,
                5.40689066e-04,
                5.44687984e-04,
                5.48686908e-04,
                5.52685839e-04,
                5.56684777e-04,
                5.60683721e-04,
                5.64682671e-04,
                5.68681628e-04,
                5.72680592e-04,
                5.76679561e-04,
                5.80678538e-04,
                5.84677520e-04,
                5.88676509e-04,
                5.92675504e-04,
                5.96674505e-04,
                6.00673512e-04,
                6.04672525e-04,
                6.08671545e-04,
                6.12670570e-04,
                6.16669602e-04,
                6.20668639e-04,
                6.24667682e-04,
                6.28666731e-04,
                6.32665786e-04,
                6.36664847e-04,
                6.40663913e-04,
                6.44662985e-04,
                6.48662063e-04,
                6.52661146e-04,
                6.56660235e-04,
                6.60659329e-04,
                6.64658428e-04,
                6.68657534e-04,
                6.72656644e-04,
                6.76655760e-04,
                6.80654881e-04,
                6.84654007e-04,
                6.88653139e-04,
                6.92652276e-04,
                6.96651417e-04,
                7.00650564e-04,
                7.04649716e-04,
                7.08648873e-04,
                7.12648035e-04,
                7.16647202e-04,
                7.20646374e-04,
                7.24645551e-04,
                7.28644732e-04,
                7.32643919e-04,
                7.36643110e-04,
                7.40642306e-04,
                7.44641506e-04,
                7.48640711e-04,
                7.52639921e-04,
                7.56639135e-04,
                7.60638354e-04,
                7.64637577e-04,
                7.68636805e-04,
                7.72636037e-04,
                7.76635274e-04,
                7.80634515e-04,
                7.84633760e-04,
                7.88633010e-04,
                7.92632264e-04,
                7.96631522e-04,
                8.00630784e-04,
                8.04630051e-04,
                8.08629321e-04,
                8.12628596e-04,
                8.16627875e-04,
                3.05134802e-05,
                2.65128005e-05,
                2.25131902e-05,
                1.85138389e-05,
                1.45145419e-05,
                1.05152466e-05,
                6.51594066e-06,
                2.51662240e-06,
                1.48270712e-06,
                5.48204644e-06,
                9.48139420e-06,
                1.34807494e-05,
                1.74801111e-05,
                2.14794789e-05,
                2.54788522e-05,
                2.94782306e-05,
                3.34776139e-05,
                3.74770017e-05,
                4.14763940e-05,
                4.54757905e-05,
                4.94751911e-05,
                5.34745957e-05,
                5.74740041e-05,
                6.14734163e-05,
                6.54728321e-05,
                6.94722514e-05,
                7.34716743e-05,
                7.74711006e-05,
                8.14705303e-05,
                8.54699632e-05,
                8.94693995e-05,
                9.34688389e-05,
                9.74682815e-05,
                1.01467727e-04,
                1.05467176e-04,
                9.32209591e-06,
                1.33214531e-05,
                1.73210675e-05,
                2.13207279e-05,
                2.53204053e-05,
                2.93200957e-05,
                3.33197964e-05,
                3.73195047e-05,
                4.13192182e-05,
                4.53189352e-05,
                4.93186544e-05,
                5.33183753e-05,
                5.73180974e-05,
                6.13178205e-05,
                6.53175446e-05,
                6.93172697e-05,
                7.33169958e-05,
                7.73167230e-05,
                8.13164514e-05,
                8.53161810e-05,
                8.93159118e-05,
                9.33156440e-05,
                9.73153776e-05,
                1.01315113e-04,
                1.05314849e-04,
                1.09314587e-04,
                1.13314326e-04,
                1.17314066e-04,
                1.21313809e-04,
                1.25313552e-04,
                1.29313297e-04,
                1.33313043e-04,
                1.37312791e-04,
                1.41312541e-04,
                1.45312291e-04,
                1.49312043e-04,
                1.53311797e-04,
                1.57311551e-04,
                1.61311307e-04,
                1.65311065e-04,
                1.69310823e-04,
                1.73310584e-04,
                1.77310345e-04,
                1.81310107e-04,
                1.85309871e-04,
                1.89309636e-04,
                1.93309403e-04,
                1.22532961e-04,
                1.26533880e-04,
                1.30534204e-04,
                1.34534285e-04,
                1.38534249e-04,
                1.42534148e-04,
                1.46534008e-04,
                1.50533842e-04,
                1.54533658e-04,
                1.58533462e-04,
                1.62533258e-04,
                1.66533048e-04,
                1.70532833e-04,
                1.74532615e-04,
                1.78532394e-04,
                1.82532171e-04,
                1.86531947e-04,
                1.90531722e-04,
                1.94531496e-04,
                1.98531270e-04,
                2.02531043e-04,
                2.06530817e-04,
                2.10530591e-04,
                2.14530365e-04,
                2.18530139e-04,
                2.22529915e-04,
                2.26529690e-04,
                2.30529467e-04,
                2.34529244e-04,
                2.38529022e-04,
                2.42528801e-04,
                2.46528581e-04,
                2.50528362e-04,
                2.54528144e-04,
                2.58527927e-04,
                2.62527711e-04,
                2.66527495e-04,
                2.70527281e-04,
                2.74527068e-04,
                2.78526856e-04,
                2.82526645e-04,
                2.86526435e-04,
                2.90526225e-04,
                2.94526017e-04,
                1.66535478e-04,
                1.70537121e-04,
                1.74537386e-04,
                1.78537288e-04,
                1.82537083e-04,
                1.86536845e-04,
                1.90536597e-04,
                1.94536349e-04,
                1.98536103e-04,
                2.02535861e-04,
                2.06535624e-04,
                2.10535392e-04,
                2.14535164e-04,
                9.77341091e-05,
                1.01735435e-04,
                1.05735448e-04,
                1.09735127e-04,
                1.13734710e-04,
                1.17734264e-04,
                1.21733809e-04,
                1.25733353e-04,
                1.29732901e-04,
                1.33732454e-04,
                1.37732011e-04,
                1.41731575e-04,
                1.45731143e-04,
                1.49730717e-04,
                1.53730295e-04,
                1.57729877e-04,
                1.61729463e-04,
                1.65729052e-04,
                1.69728645e-04,
                1.73728241e-04,
                1.77727840e-04,
                1.81727442e-04,
                1.85727046e-04,
                1.89726653e-04,
                1.93726262e-04,
                1.97725873e-04,
                2.01725487e-04,
                2.05725102e-04,
                2.09724720e-04,
                2.13724339e-04,
                2.17723960e-04,
                2.21723584e-04,
                2.25723208e-04,
                2.29722835e-04,
                2.33722464e-04,
                2.37722094e-04,
                2.41721725e-04,
                2.45721359e-04,
                2.49720994e-04,
                2.53720630e-04,
                2.57720268e-04,
                2.61719908e-04,
                2.65719549e-04,
                2.69719192e-04,
                2.73718836e-04,
                2.77718482e-04,
                2.81718129e-04,
                2.85717778e-04,
                2.89717428e-04,
                2.93717079e-04,
                2.97716732e-04,
                3.01716387e-04,
                3.05716043e-04,
                3.09715700e-04,
                3.13715359e-04,
                3.17715019e-04,
                3.21714680e-04,
                3.25714343e-04,
                1.09390779e-04,
                1.13388883e-04,
                1.17388140e-04,
                1.21387690e-04,
                1.25387329e-04,
                1.29387002e-04,
                1.33386694e-04,
                1.37386400e-04,
                1.41386117e-04,
                1.45385845e-04,
                1.49385581e-04,
                1.53385324e-04,
                1.57385075e-04,
                1.61384832e-04,
                1.65384595e-04,
                1.69384362e-04,
                1.73384134e-04,
                1.77383910e-04,
                1.81383689e-04,
                1.85383471e-04,
                1.89383255e-04,
                1.93383042e-04,
                1.97382831e-04,
                2.01382623e-04,
                2.05382415e-04,
                2.09382210e-04,
                2.13382005e-04,
                2.17381803e-04,
                2.21381601e-04,
                2.25381401e-04,
                2.29381201e-04,
                2.33381003e-04,
                2.37380805e-04,
                2.41380609e-04,
                2.45380413e-04,
                2.49380218e-04,
                2.53380024e-04,
                2.57379831e-04,
                2.61379639e-04,
                2.65379447e-04,
                2.69379256e-04,
                2.73379066e-04,
                2.77378877e-04,
                2.81378688e-04,
                2.85378500e-04,
                2.89378312e-04,
                2.93378126e-04,
                2.97377940e-04,
                3.01377755e-04,
                3.05377570e-04,
                3.09377386e-04,
                3.13377203e-04,
                3.17377020e-04,
                3.21376838e-04,
                3.25376657e-04,
                1.25688980e-04,
                1.29688381e-04,
                1.33687608e-04,
                1.37686909e-04,
                1.41686306e-04,
                1.45685778e-04,
                1.49685302e-04,
                1.53684859e-04,
                1.57684439e-04,
                1.61684034e-04,
                1.65683639e-04,
                1.69683250e-04,
                1.73682867e-04,
                1.77682487e-04,
                1.81682110e-04,
                1.85681735e-04,
                1.89681362e-04,
                1.93680991e-04,
                1.97680621e-04,
                2.01680252e-04,
                2.05679885e-04,
                2.09679518e-04,
                2.13679153e-04,
                2.17678789e-04,
                2.21678426e-04,
                2.25678063e-04,
                2.29677702e-04,
                2.33677342e-04,
                2.37676982e-04,
                2.41676624e-04,
                2.45676267e-04,
                2.49675910e-04,
                2.53675555e-04,
                2.57675200e-04,
                2.61674847e-04,
                3.91335557e-06,
                8.58060148e-08,
                4.08500717e-06,
                8.08421473e-06,
                1.20834332e-05,
                1.60826702e-05,
                2.00819312e-05,
                2.40812188e-05,
                2.80805339e-05,
                3.20798761e-05,
                3.60792443e-05,
                4.00786368e-05,
                4.40780521e-05,
                4.80774882e-05,
                5.20769435e-05,
                5.60764161e-05,
                6.00759047e-05,
                6.40754077e-05,
                6.80749239e-05,
                7.20744519e-05,
                7.60739908e-05,
                8.00735395e-05,
                8.40730972e-05,
                8.80726631e-05,
                9.20722363e-05,
                9.60718164e-05,
                1.00071403e-04,
                1.04070995e-04,
                1.08070592e-04,
                1.12070194e-04,
                1.16069800e-04,
                1.20069411e-04,
                1.24069025e-04,
                1.28068643e-04,
                1.32068264e-04,
                1.36067888e-04,
                1.40067515e-04,
                1.44067145e-04,
                1.48066777e-04,
                1.52066411e-04,
                1.56066048e-04,
                1.60065687e-04,
                1.64065328e-04,
                1.68064971e-04,
                1.72064615e-04,
                1.76064262e-04,
                1.80063910e-04,
                1.84063560e-04,
                1.88063211e-04,
                1.92062864e-04,
                1.96062519e-04,
                2.00062175e-04,
                2.04061832e-04,
                2.08061491e-04,
                2.12061151e-04,
                2.16060812e-04,
                2.20060475e-04,
                2.24060138e-04,
                2.28059804e-04,
                2.32059470e-04,
                2.36059137e-04,
                2.40058806e-04,
                2.44058476e-04,
                2.48058147e-04,
                2.52057819e-04,
                2.56057493e-04,
                2.60057167e-04,
                2.64056843e-04,
                2.68056519e-04,
                2.72056197e-04,
                2.76055876e-04,
                2.80055556e-04,
                2.84055237e-04,
                2.88054919e-04,
                2.92054602e-04,
                2.96054286e-04,
                3.00053971e-04,
                3.04053657e-04,
                3.08053344e-04,
                6.06275091e-05,
                5.66290910e-05,
                5.26301632e-05,
                4.86312029e-05,
                4.46322542e-05,
                4.06333012e-05,
                3.66343304e-05,
                3.26353350e-05,
                2.86363129e-05,
                2.46372643e-05,
                2.06381903e-05,
                1.66390925e-05,
                1.26399728e-05,
                8.64083277e-06,
                4.64167419e-06,
                6.42498604e-07,
                3.35669256e-06,
                7.35589799e-06,
                1.13551165e-05,
                1.53543469e-05,
                1.93535884e-05,
                2.33528400e-05,
                2.73521008e-05,
                3.13513702e-05,
                3.53506476e-05,
                3.93499323e-05,
                4.33492237e-05,
                4.73485215e-05,
                5.13478251e-05,
                5.53471343e-05,
                5.93464486e-05,
                6.33457677e-05,
                6.73450913e-05,
                7.13444192e-05,
                7.53437511e-05,
                7.93430869e-05,
                8.33424263e-05,
                8.73417692e-05,
                9.13411154e-05,
                9.53404648e-05,
                9.93398172e-05,
                1.03339173e-04,
                1.07338531e-04,
                1.11337892e-04,
                1.15337255e-04,
                1.19336622e-04,
                1.23335990e-04,
                1.27335361e-04,
                1.31334735e-04,
                1.35334111e-04,
                1.39333489e-04,
                1.43332869e-04,
                1.47332252e-04,
                1.51331636e-04,
                1.55331023e-04,
                1.59330412e-04,
                1.63329803e-04,
                1.67329196e-04,
                1.71328591e-04,
                1.75327989e-04,
                1.79327388e-04,
                1.83326789e-04,
                1.87326191e-04,
                1.91325596e-04,
                1.95325003e-04,
                1.99324412e-04,
                2.03323822e-04,
                2.07323235e-04,
                2.11322649e-04,
                2.15322065e-04,
                2.19321483e-04,
                2.23320902e-04,
                2.27320324e-04,
                2.31319747e-04,
                2.35319172e-04,
                2.39318599e-04,
                2.43318027e-04,
                2.47317457e-04,
                2.51316889e-04,
                2.55316323e-04,
                2.59315758e-04,
                2.63315195e-04,
                2.67314634e-04,
                2.71314075e-04,
                2.75313517e-04,
                2.79312961e-04,
                1.90235082e-04,
                1.94233610e-04,
                1.98232784e-04,
                2.02232250e-04,
                1.13079325e-04,
                1.17079733e-04,
                1.21079607e-04,
                1.25079364e-04,
                1.29079062e-04,
                1.33078714e-04,
                1.37078329e-04,
                1.41077915e-04,
                1.45077481e-04,
                1.49077032e-04,
                1.53076572e-04,
                1.57076104e-04,
                1.61075630e-04,
                1.65075152e-04,
                1.69074672e-04,
                1.73074190e-04,
                1.77073707e-04,
                1.81073224e-04,
                1.85072741e-04,
                1.89072258e-04,
                1.93071777e-04,
                1.97071296e-04,
                6.06673599e-05,
                6.46719383e-05,
                6.86736397e-05,
                7.26742997e-05,
                7.66745016e-05,
                8.06744688e-05,
                8.46743030e-05,
                8.86740563e-05,
                9.26737577e-05,
                9.66734242e-05,
                1.00673066e-04,
                1.04672690e-04,
                1.08672300e-04,
                1.12671899e-04,
                1.16671490e-04,
                1.20671073e-04,
                1.24670650e-04,
                1.28670222e-04,
                1.32669789e-04,
                1.36669353e-04,
                1.40668914e-04,
                1.44668472e-04,
                1.48668029e-04,
            ]
        )

        # Define a geometry

        N = 3**2
        h = np.pi
        L = h * float(N)

        mesh = GooseFEM.Mesh.Quad4.FineLayer(N, N, h)

        coor = mesh.coor()
        conn = mesh.conn()
        dofs = mesh.dofs()

        plastic = mesh.elementsMiddleLayer()
        elastic = np.setdiff1d(np.arange(mesh.nelem()), plastic)

        left = mesh.nodesLeftOpenEdge()
        right = mesh.nodesRightOpenEdge()
        dofs[left] = dofs[right]

        top = mesh.nodesTopEdge()
        bottom = mesh.nodesBottomEdge()
        top.size
        iip = np.concatenate((dofs[bottom].ravel(), dofs[top].ravel()))

        c = 1.0
        G = 1.0
        K = 10.0 * G
        rho = G / c**2.0
        qL = 2.0 * np.pi / L
        qh = 2.0 * np.pi / h
        alpha = np.sqrt(2.0) * qL * c * rho
        dt = 1.0 / (c * qh) / 10.0

        k = 2.0

        generators = prrng.pcg32_array(np.arange(N), np.zeros(N))
        epsy = np.hstack((generators.random([1]), generators.weibull([1000], k)))
        epsy *= 1.0e-3
        epsy += 1.0e-5
        epsy = np.cumsum(epsy, 1)

        # Initialise system

        system = FrictionQPotFEM.Generic2d.System(coor, conn, dofs, iip, elastic, plastic)
        system.setMassMatrix(rho * np.ones(mesh.nelem()))
        system.setDampingMatrix(alpha * np.ones(mesh.nelem()))
        system.setElastic(K * np.ones(elastic.size), G * np.ones(elastic.size))
        system.setPlastic(K * np.ones(plastic.size), G * np.ones(plastic.size), epsy)
        system.setDt(dt)

        # Run

        dF = np.zeros((1001, 2, 2))
        dF[1:, 0, 0] = 0.004 / 1000.0

        compute_Eps = np.zeros(dF.shape[0])
        compute_Sig = np.zeros(dF.shape[0])
        compute_Sig_plastic = np.zeros(dF.shape[0])
        quad = system.quad()
        dV = quad.AsTensor(2, quad.dV())

        for inc in range(dF.shape[0]):

            u = system.u()

            for i in range(mesh.nnode()):
                for j in range(mesh.ndim()):
                    for k in range(mesh.ndim()):
                        u[i, j] += dF[inc, j, k] * (coor[i, k] - coor[0, k])

            system.setU(u)
            system.minimise()

            Epsbar = np.average(system.Eps(), weights=dV, axis=(0, 1))
            Sigbar = np.average(system.Sig(), weights=dV, axis=(0, 1))
            compute_Eps[inc] = GMat.Epsd(Epsbar)
            compute_Sig[inc] = GMat.Sigd(Sigbar)
            compute_Sig_plastic[inc] = GMat.Sigd(np.mean(system.plastic_Sig(), axis=(0, 1)))

        self.assertTrue(np.allclose(compute_Eps, check_Eps))
        self.assertTrue(np.allclose(compute_Sig, check_Sig))
        self.assertTrue(np.allclose(compute_Sig_plastic, check_Sig_plastic))


if __name__ == "__main__":

    unittest.main()
